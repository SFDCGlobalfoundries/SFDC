<apex:page standardController="MRS_Layer_Association__c" extensions="MRSLayerChipSummaryExtn" showHeader="false" sideBar="false" standardStylesheets="false" contentType="application/vnd.ms-excel#LayerChipSummary.csv" cache="true" language="en-US">
         <apex:variable value="{!1}" var="counter"/>
    
    Layer Chip Summary     
    Customer Name:,{!strCustomerName},
    Mask Set Title:,{!objLayerSummaryDetails.Mask_Set_Title_Name__c},,Mask Layer:,{!objLayerSummaryDetails.name}{!objLayerSummaryDetails.Mask_Layer_Rev__c}{!if(objLayerSummaryDetails.ROM_Code__c != '' && objLayerSummaryDetails.ROM_Code__c != '####','('+objLayerSummaryDetails.ROM_Code__c+')','')},
    {!IF(strSelectedLayerChipStatus!=null && strSelectedLayerChipStatus!='','Layer Chip Status: ,'+strSelectedLayerChipStatus,'')}
    {!IF(deviceSelectedValue!=null && deviceSelectedValue!='','Device ID: ,'+deviceSelectedValue,'')}
    {!IF(ptrfSelectedValue!=null && ptrfSelectedValue!='','PTRF/DRT Number: ,'+ptrfSelectedValue,'')}
    {!IF(techgeoSelectedValue!=null && techgeoSelectedValue!='','Tech Geo: ,'+techgeoSelectedText,'')}
    
    Selected Layer Details
        
    No.,Mask Layer(ROM Code),Layer Status,{!IF(boolShowTechGeo,'Tech Geo,',',')}{!IF(boolGDSOUTReviewCustomer,'GDSOUT Review Customer,','')}{!IF(boolGDSOUTReviewFoundry,'GDSOUT Review Foundry,','')}{!IF(boolFrameMockupCustomer,'Frame Mockup Review Customer,','')}{!IF(boolFrameMockupFoundry,'Frame Mockup Review Foundry,','')}{!IF(boolSendDataPrime,'Send Data Prime,','')}{!IF(boolSendDataFrame,'Send Data Frame,','')}{!IF(boolDRW,'ORC,','')}{!IF(boolORC,'DRW,','')}{!IF(boolCustomerRemoteJobviewPrime,'Customer Remote Jobview Prime,','')}{!IF(boolCustomerRemoteJobviewFrame,'Customer Remote Jobview Frame,','')}{!IF(boolFoundryRemoteJobviewPrime,'Foundry Remote Jobview Prime,','')}{!IF(boolFoundryRemoteJobviewFrame,'Foundry Remote Jobview Frame,','')}{!IF(boolMEBESReceivedPrime,'MEBES Received Prime,','')}{!IF(boolMEBESReceivedFrame,'MEBES Received Frame,','')}{!IF(boolMEBESJobviewCustomer,'MEBES Jobview Customer,','')}{!IF(boolMEBESJobviewFoundry,'MEBES Jobview Foundry,','')}{!IF(boolMEBESJobviewTapeoutCenter,'MEBES Jobview Tapeout Centre,','')}{!IF(boolMEBESJobviewTapeoutAPPLICATIONS,'MEBES Jobview Tapeout Applications,','')}{!IF(boolMEBESJobviewGlobalShuttle,'MEBES Jobview GlobalShuttle,','')}{!IF(boolMEBESJobviewMDP,'DRR,','')}{!IF(boolMEBESJobviewTDTIMPW,'MEBES Jobview TDTI-MPW,','')}
    1,{!objLayerSummaryDetails.name}{!objLayerSummaryDetails.Mask_Layer_Rev__c}{!if(objLayerSummaryDetails.ROM_Code__c != '' && objLayerSummaryDetails.ROM_Code__c != '####','('+objLayerSummaryDetails.ROM_Code__c+')','')},{!objLayerSummaryDetails.Layer_Status__c},{!IF(boolShowTechGeo,strTechGeo,'')},{!IF(boolGDSOUTReviewCustomer,objLayerSummaryDetails.Customer_GDSOUT_Review__c+',','')}{!IF(boolGDSOUTReviewFoundry,objLayerSummaryDetails.Foundry_GDSOUT_Review__c+',','')}{!IF(boolFrameMockupCustomer,objLayerSummaryDetails.Customer_Frame_Mockup__c+',','')}{!IF(boolFrameMockupFoundry,objLayerSummaryDetails.Foundry_Frame_Mockup__c+',','')}{!IF(boolSendDataPrime,objLayerSummaryDetails.Send_Prime_Data__c+',','')}{!IF(boolSendDataFrame,objLayerSummaryDetails.Send_Frame_Data__c+',','')}{!IF(boolORC,objLayerSummaryDetails.ORC__c+',','')}{!IF(boolDRW,objLayerSummaryDetails.DRW__c+',','')}{!IF(boolCustomerRemoteJobviewPrime,objLayerSummaryDetails.Customer_Prime_Remote_Jobview_Setup__c+',','')}{!IF(boolCustomerRemoteJobviewFrame,objLayerSummaryDetails.Customer_Frame_Remote_Jobview_Setup__c+',','')}{!IF(boolFoundryRemoteJobviewPrime,objLayerSummaryDetails.Foundry_Prime_Remote_Jobview_Setup__c+',','')}{!IF(boolFoundryRemoteJobviewFrame,objLayerSummaryDetails.Foundry_Frame_Remote_Jobview_Setup__c+',','')}{!IF(boolMEBESReceivedPrime,objLayerSummaryDetails.Prime_MEBES_Received__c+',','')}{!IF(boolMEBESReceivedFrame,objLayerSummaryDetails.Frame_MEBES_Received__c+',','')}{!IF(boolMEBESJobviewCustomer,objLayerSummaryDetails.Customer_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewFoundry,objLayerSummaryDetails.Foundry_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewTapeoutCenter,objLayerSummaryDetails.Tapeout_Centre_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewTapeoutAPPLICATIONS,objLayerSummaryDetails.Tapeout_Applications_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewGlobalShuttle,objLayerSummaryDetails.GlobalShuttle_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewMDP,objLayerSummaryDetails.MDP_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewTDTIMPW,objLayerSummaryDetails.TDTI_MPW_MEBES_Jobview__c+',','')}

    Layer Chip Summary
    
    No.,Chip,PTRF/DRT Number,Layer Chip Status,{!IF(boolGDSOUTReviewCustomer,'GDSOUT Review Customer,','')}{!IF(boolGDSOUTReviewFoundry,'GDSOUT Review Foundry,','')}{!IF(boolFrameMockupCustomer,'Frame Mockup Review Customer,','')}{!IF(boolFrameMockupFoundry,'Frame Mockup Review Foundry,','')}{!IF(boolSendDataPrime,'Send Data Prime,','')}{!IF(boolSendDataFrame,'Send Data Frame,','')}{!IF(boolDRW,'ORC,','')}{!IF(boolORC,'DRW,','')}{!IF(boolCustomerRemoteJobviewPrime,'Customer Remote Jobview Prime,','')}{!IF(boolCustomerRemoteJobviewFrame,'Customer Remote Jobview Frame,','')}{!IF(boolFoundryRemoteJobviewPrime,'Foundry Remote Jobview Prime,','')}{!IF(boolFoundryRemoteJobviewFrame,'Foundry Remote Jobview Frame,','')}{!IF(boolMEBESReceivedPrime,'MEBES Received Prime,','')}{!IF(boolMEBESReceivedFrame,'MEBES Received Frame,','')}{!IF(boolMEBESJobviewCustomer,'MEBES Jobview Customer,','')}{!IF(boolMEBESJobviewFoundry,'MEBES Jobview Foundry,','')}{!IF(boolMEBESJobviewTapeoutCenter,'MEBES Jobview Tapeout Centre,','')}{!IF(boolMEBESJobviewTapeoutAPPLICATIONS,'MEBES Jobview Tapeout Applications,','')}{!IF(boolMEBESJobviewGlobalShuttle,'MEBES Jobview GlobalShuttle,','')}{!IF(boolMEBESJobviewMDP,'DRR,','')}{!IF(boolMEBESJobviewTDTIMPW,'MEBES Jobview TDTI-MPW,','')}
    <apex:variable value="{!1}" var="counter"/>
    <apex:repeat value="{!lstLayerChipSummary}" var="objWrapper">
    {!counter},{!objWrapper.Chip_Name__c},{!IF(objWrapper.PTRF_Or_DRT__c=='DRT',objWrapper.DRT__r.name,objWrapper.PTRF__r.name)},{!objWrapper.Layer_Chip_Status__c},{!IF(boolGDSOUTReviewCustomer,objWrapper.Customer_GDSOUT_Review__c+',','')}{!IF(boolGDSOUTReviewFoundry,objWrapper.Foundry_GDSOUT_Review__c+',','')}{!IF(boolFrameMockupCustomer,objWrapper.Customer_Frame_Mockup__c+',','')}{!IF(boolFrameMockupFoundry,objWrapper.Foundry_Frame_Mockup__c+',','')}{!IF(boolSendDataPrime,objWrapper.Send_Prime_Data__c+',','')}{!IF(boolSendDataFrame,objWrapper.Send_Frame_Data__c+',','')}{!IF(boolORC,objWrapper.ORC__c+',','')}{!IF(boolDRW,objWrapper.DRW__c+',','')}{!IF(boolCustomerRemoteJobviewPrime,objWrapper.Customer_Prime_Remote_Jobview_Setup__c+',','')}{!IF(boolCustomerRemoteJobviewFrame,objWrapper.Customer_Frame_Remote_Jobview_Setup__c+',','')}{!IF(boolFoundryRemoteJobviewPrime,objWrapper.Foundry_Prime_Remote_Jobview_Setup__c+',','')}{!IF(boolFoundryRemoteJobviewFrame,objWrapper.Foundry_Frame_Remote_Jobview_Setup__c+',','')}{!IF(boolMEBESReceivedPrime,objWrapper.Prime_MEBES_Received__c+',','')}{!IF(boolMEBESReceivedFrame,objWrapper.Frame_MEBES_Received__c+',','')}{!IF(boolMEBESJobviewCustomer,objWrapper.Customer_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewFoundry,objWrapper.Foundry_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewTapeoutCenter,objWrapper.Tapeout_Centre_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewTapeoutAPPLICATIONS,objWrapper.Tapeout_Applications_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewGlobalShuttle,objWrapper.GlobalShuttle_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewMDP,objWrapper.MDP_MEBES_Jobview__c+',','')}{!IF(boolMEBESJobviewTDTIMPW,objWrapper.TDTI_MPW_MEBES_Jobview__c+',','')}
    <apex:variable value="{!counter+1}" var="counter"/>
    </apex:repeat>
    
</apex:page>