<!--
 Type Name: VFDeProvisionSpec
 Author: Cognizant Technology Solutions
 Created Date: 12-June-2013
 Reason: This page displays the ability to Provision Documents.
 Change History:
 Author: Cognizant Technology Solutions
 Modified Date: 26-Sep-2013
 Reason: Case 34664
 ……..  
 …….. 
 ……..
-->


<apex:page standardController="Design_Spec__c" extensions="ClsDeProvisionSpecController">

<script type="text/javascript">
    function checkAll(cb,section)
        {
            //alert(section);
            
            var inputElem = document.getElementsByTagName('input');                     
            for(var i=0; i<inputElem.length; i++)
            {                                                   
                    if(inputElem[i].id.indexOf(section)!=-1){
                        inputElem[i].checked = cb.checked;
                        //alert('inside for loop.'+cb.checked);
                    }               
            }
        }
        
     function checkContacts(cb,accid){
        var inputElem = document.getElementsByTagName('input');                            
        for(var i=0; i<inputElem.length; i++){ 
            if(inputElem[i].parentNode.getAttribute('rowid')==accid)                                                 
                inputElem[i].checked = cb.checked;               
            }
    }
</script>
  
<apex:form id="theForm">
                                         
        <apex:pageBlock mode="detail" title="Specification DeProvisioning">
            
            <apex:pagemessages id="msg" /> 
            <apex:pageBlockButtons location="both" >
                <!--apex:commandButton value="DeProvision From Contacts" action="{!removeProvisioningRecords}"  rendered="{!((isValidProfile)&&(isValidReleaseStatusForProvisioning)&& (isValidTechGeometry)&&(isValidSpecificationType) && (provionsedUser))}"/>&nbsp;&nbsp;--> <!--modified for case 34664-->           
                <apex:commandButton value="DeProvision From Contacts" action="{!removeProvisioningRecords}"  rendered="{!((isValidProfile)&&(isValidReleaseStatusForProvisioning)&& (isValidTechGeometry)&&(isValidSpecificationType))}"/>&nbsp;&nbsp; <!--added for case 34665 -->           
                
                <apex:commandButton value="Cancel" action="{!cancel}" status="addAccountStatus" reRender="theForm"/>
           </apex:pageBlockButtons>
            
            <!--apex:pageblockSection title="Specification Information" columns="2"   rendered="{!((isValidProfile)&&(isValidReleaseStatusForProvisioning)&& (isValidTechGeometry)&&(isValidSpecificationType)&&(provionsedUser))}"--><!--commentedfor case 34665-->    
            <apex:pageblockSection title="Specification Information" columns="2"   rendered="{!((isValidProfile)&&(isValidReleaseStatusForProvisioning)&& (isValidTechGeometry)&&(isValidSpecificationType))}"><!--addedfor case 34665-->    
            
                <apex:repeat value="{!$ObjectType.Design_Spec__c.FieldSets.Provisioning_Fields}" var="f">
                    <apex:outputField value="{!objDesignSpec[f]}"/>                     
                </apex:repeat>
                
            </apex:pageblockSection>
            
            <!--apex:pageBlockSection title="DeProvision From Contacts" columns="1" collapsible="true"   rendered="{!((isValidProfile)&&(isValidReleaseStatusForProvisioning)&& (isValidTechGeometry)&&(isValidSpecificationType)&&(provionsedUser))}"--><!--commented for case 34665-->    
            <apex:pageBlockSection title="DeProvision From Contacts" columns="1" collapsible="true"   rendered="{!((isValidProfile)&&(isValidReleaseStatusForProvisioning)&& (isValidTechGeometry)&&(isValidSpecificationType))}"><!--added for case 34665-->    
              
               
              <apex:pageBlock > 
                   
               <apex:repeat value="{!lstAccUserWrapper}" var="accUser" id="provisioningTable">
                   <apex:variable var="count" value="{!1}"/>
                         <!--apex:outputText value="Customer - {!accUser.accName}"  style="font-weight: bold;font-size:14px"/-->              
                         <apex:pageBlockSection title="Customer - {!accUser.accName} ({!accUser.accShortName})" columns="1">  
                   <!-- apex:pageBlock --> 
                   <apex:pageBlockTable value="{!accUser.Sortedcontactlist}" var="mapUser" width="100%" rendered="{!accUser.lstUserSize>0}"> <!--Cognizant modified on 25/11/2013---->
                                     
                       <apex:column >
                            
                            <apex:facet name="header">
                                <apex:inputcheckbox id="selectAllContacts" onclick="checkContacts(this,'{!accUser.accId}')" />
                            </apex:facet>
                           <div id="divid" rowid="{!accUser.accId}">
                                <apex:inputCheckBox value="{!accUser.mapUserIdToChecked[mapUser]}" id="userCheckBox" />
                           </div>
                           
                       </apex:column>
                       <apex:column headerValue="Contact Name" >
                            <apex:outputText value="{!mapUserNames[mapUser].Name}" />             
                       </apex:column>
                       <apex:column headerValue="Contact Email" >
                            <apex:outputText value="{!mapUserNames[mapUser].Email}" />             
                       </apex:column>
                   </apex:pageBlockTable>
                   <apex:outputLabel value="No Active Contacts found corresponding to this Customer for De-Provisioning" rendered="{!accUser.lstUserSize=0}"/>
                   
                    <!-- /apex:pageBlock -->
                                   
                   <apex:variable var="count" value="{!count + 1}"/>
                  </apex:pageBlockSection>      
               </apex:repeat> 
                <apex:outputLabel value="No Customer found for De-Provisioning" rendered="{!lstAccUserWrapper.size=0}"/>       
               </apex:pageBlock>
           </apex:pageBlockSection> 
            
      </apex:pageBlock>
      
 </apex:form>
    
</apex:page>