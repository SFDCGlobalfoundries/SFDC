<!-- 
   Type Name:  usersearch.page
   Author: Cognizant 
   Created Date: 05/16/2014
   Reason: 
   Change History:
   Author: 
   Modified Date: 
   Reason: 
    -->
<apex:page title="User Lookup" showHeader="false" standardController="Bug__c" extensions="BugSearch" sidebar="false">
    <apex:form id="userSelect">
        <apex:pageBlock >
        <apex:pageMessages />
            <apex:pageBlockSection > 
            <apex:inputText value="{!userSearchString}" label="Search By Name" size="70"/>
            <apex:commandButton value="Search" action="{!SearchUser}"/>
            </apex:pageBlockSection>
        </apex:pageBlock>
        <apex:outputPanel id="usersearchSuccess" rendered="{!displayReadOnly = true}">     
            <apex:pageBlock title="Users Selected:">
                <apex:pageBlockButtons location="Top">
                    <apex:commandButton value="Clear" onclick="setClearButton();"/>
                </apex:pageBlockButtons>
                <apex:pageblockTable value="{!listuserWrapperSelected}" var="userDetail" >
                    <apex:column >  
                        <apex:inputCheckbox value="{!userDetail.isSelected}" onclick="addUser();" disabled="{!displayReadOnly == true}"/>                      
                    </apex:column> 
                    <apex:column value="{!userDetail.eachUser.Name}" title="Name"/> 
                    <apex:column value="{!userDetail.eachUser.username}" title="Username"/> 
                    <apex:column value="{!userDetail.eachUser.email}" title="Email"/>                     
                </apex:pageblockTable>
            </apex:pageBlock>     
        </apex:outputPanel>
        <apex:outputPanel id="usersearchSuccess1" rendered="{!searchflag == true}">   
            <apex:pageBlock title="Users Returned:">
                <apex:pageBlockButtons location="bottom">                    
                    <apex:commandButton value="<< Previous"  rerender="usersearchSuccess1" action="{!PreviousUsers}" disabled="{!!hasprevious}" status="TableUpdateStatus"/>
                    <apex:commandButton value="Next >>"  rerender="usersearchSuccess1" action="{!NextUsers}" disabled="{!!hasnext}" status="TableUpdateStatus"/>
                </apex:pageBlockButtons>
                <apex:pageblockbuttons location="Top">
                    <apex:commandButton value="Add" onclick="setUserIds();"/>
                </apex:pageblockbuttons>
                <apex:pageblockTable value="{!listUserPage}" var="userDetail" >
                    <apex:column >  
                        <apex:inputCheckbox value="{!userDetail.isSelected}" onclick="addUser();" disabled="{!displayReadOnly == true}"/>                      
                    </apex:column> 
                    <apex:column value="{!userDetail.eachUser.Name}" title="Name"/> 
                    <apex:column value="{!userDetail.eachUser.username}" title="Username"/> 
                    <apex:column value="{!userDetail.eachUser.email}" title="Email"/>                      
                </apex:pageblockTable>
            </apex:pageBlock>     
        </apex:outputPanel>
   <apex:actionFunction name="addUser" action="{!addAllUsers}">     
   </apex:actionFunction> 
    </apex:form>
    <script>
        function setUserIds(){
            if('{!searchUserString}' != ''){
                top.window.opener.setUserIdsInParent('{!searchUserString}','{!searchUserId}','{!clearFlag}');
                top.close();
            } 
        }
        function setClearButton(){            
                top.window.opener.setUserIdsInParent('{!searchUserString}','{!searchUserId}','{!clearFlag}');
                top.close();            
        }        
    </script>
</apex:page>