<!-- 
Author: Shyam Ravindra Nair
Description: UI for AMs to enter additional details before approval
History:
SNair     28012015     - code creation
SNair     03022015     - added buttons for Approve and Reject
SNair     03022015     - updated logic for field validation
 -->

<apex:page standardController="CuSR_Approval_Process__c"
    extensions="CuSRApprovalViewFormExtension" tabStyle="CuSR_Form__c">

    <apex:form >
        <apex:sectionHeader title="
    {!$ObjectType.CuSR_Approval_Process__c.label} Edit"
            subtitle="{!cusrApproval.Name}" />
        <apex:pageBlock title="CuSR Approval Form">
            <apex:pageBlockButtons >
                <apex:commandButton value="Save" action="{!saveAMData}" />
                <apex:commandButton value="Approve" action="{!amApproved}" />
                <apex:commandButton value="Reject" action="{!amRejected}" />
                <apex:commandButton value="Cancel" action="{!back}" immediate="true" />
            </apex:pageBlockButtons>
            <apex:pageBlockSection collapsible="false"
                title="CuSR Approval Details">
                <apex:outputField value="{!cusrApproval.Name}" />
                <apex:outputField value="{!cusrApproval.Status__c}" />
                <apex:outputField value="{!cusrApproval.CuSR_Form__c}" />
                <apex:outputField value="{!cusrApproval.Type_of_Approver__c}" />
            </apex:pageBlockSection>
            <apex:pageBlockSection collapsible="false" title="Approver's Details">
                <apex:outputField value="{!cusrApproval.No_of_Approvers__c}" />
                <apex:outputField value="{!cusrApproval.Do_you_require_approval_from_all_users__c}" />
                <apex:outputField value="{!cusrApproval.Approver1__c}"
                    rendered="{!cusrApproval.Approver1__c != null}" />
                <apex:outputField value="{!cusrApproval.Approver2__c}"
                    rendered="{!cusrApproval.Approver2__c != null}" />
                <apex:outputField value="{!cusrApproval.Approver3__c}"
                    rendered="{!cusrApproval.Approver3__c != null}" />
                <apex:outputField value="{!cusrApproval.Approver4__c}"
                    rendered="{!cusrApproval.Approver4__c != null}" />
                <apex:outputField value="{!cusrApproval.Approver5__c}"
                    rendered="{!cusrApproval.Approver5__c != null}" />
            </apex:pageBlockSection>
            <apex:pageBlockSection title="AM Approver Section" columns="1"
                collapsible="false">
                <apex:inputField value="{!cusrApproval.Will_GLOBALFOUNDRIES_charge_the_customer__c}">
                    <apex:actionSupport event="onchange" reRender="justification1" />
                </apex:inputField>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="justification1" columns="1">
                <apex:inputField value="{!cusrApproval.If_No_Please_provide_justification__c}"
                    rendered="{!cusrApproval.Will_GLOBALFOUNDRIES_charge_the_customer__c == 'No'}" />
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1">
                <apex:inputField value="{!cusrApproval.Does_the_customer_agree_to_pay_for_CUSR__c}">
                    <apex:actionSupport event="onchange" reRender="justification2" />
                </apex:inputField>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="justification2" columns="1">
                <apex:inputField value="{!cusrApproval.Pricing_quote_reference_number__c}"
                    rendered="{!cusrApproval.Does_the_customer_agree_to_pay_for_CUSR__c == 'Yes'}" />
                <apex:inputField value="{!cusrApproval.If_No_Please_provide_justification_2__c}"
                    rendered="{!cusrApproval.Does_the_customer_agree_to_pay_for_CUSR__c == 'No'}" />
            </apex:pageBlockSection>
            <apex:pageBlockSection >
                <apex:inputField value="{!cusrApproval.Comments__c}" />
            </apex:pageBlockSection>
        </apex:pageBlock>
    </apex:form>

</apex:page>