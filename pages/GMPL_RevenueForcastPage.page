<!--  
* @ Author          :- Navneet Rajput
* @ Organization    :- Cognizant Technology solutions
* @ Project         :- GMPL/RX009
* @ Description     :-   
* @ Date            :-18th March 2014
* @ Change History  :- 
-->
 
<apex:page standardController="Revenue_Forecast__c" 
           extensions="GMPL_RevenueForcastCls"
           tabStyle="Revenue_Forecast__c"
           showHeader="true"
           sidebar="true"
           recordSetVar="unused"
           Id="pageId"> 
           
           <style type="text/css">
                #innerTable {border-spacing:0px;border-collapse:collapse;text-align:center;}
                #innerTable tr td{border:1px solid #e0e3e5;text-align:center;}
                #headerTable {border-spacing:0px;border-collapse:collapse;}
                #headerTable tr td{border:1px solid #e0e3e5;text-align:center;}
                #qtrDiv {overflow:auto;position:relative;width:1200px;height:175px;text-align:left;display:block}
                .outerTable {text-align:center;border-spacing: 0px;background-color:#FFFFFF;border:1px solid #e0e3e5;vertical-align:middle;align:left;border-collapse:collapse;}
                .outerTr{color: #000;font-size: .9em;font-weight: bold;}
                .outerTd{vertical-align:middle;text-align:center;}
                .firstTable{background-color:#ececec;background-repeat: repeat-x;border-spacing: -10px;border-color: #ececec;border:1px solid #e0e3e5;border-collapse:collapse;}
            </style>
            
            <c:JqueryLibrary />
            
           <apex:form id="formId">
                  <!--
                <apex:variable var="positioncount" 
                               value="{!0}" 
                               id="positionId">
                    
                </apex:variable>    
                   
                <apex:actionFunction name="removeRowIndex" 
                                     action="{!removeSelectedRow}" 
                                     reRender="positionId,pageBlockId"
                                     oncomplete="unblockPage();">
                                     
                </apex:actionFunction>
                 -->
                <apex:actionFunction name="SaverevenueForcastingInfo" 
                                     action="{!SaverevenueForcastingInfo}"> 
                                     
                </apex:actionFunction>
                
                <apex:actionFunction name="cancle" 
                                     action="{!cancel}"> 
                </apex:actionFunction>
                
                <apex:pageBlock title="" mode="edit" id="pageBlockId">
                    <apex:pageMessages />
                    <apex:outputPanel id="outputPanelId" rendered="{!isEditable}">
	                    <div id="qtrDiv">
	                        <table class="outerTable" id="table">
	                            <tr class="outerTr">
	                                <td class="outerTd" style="width:150px">
	                                    <table id="innerTable" style="width:150px">
	                                             <tr>                                                         
	                                                 <td style="height:17px;border-top-style:none;width:200px;border-right-style:none;border-left-style:none;">
	                                                     <apex:outputText value="Year"/>
	                                                 </td>
	                                             </tr>
	                                             <tr>
	                                                 <td style="height:23px;width:200px;border-right-style:none;border-left-style:none;">
	                                                     <apex:outputText value="Average Sales Price" />
	                                                </td>
	                                             </tr>
	                                             <tr>                                                         
	                                                 <td style="height:28px;width:200px;border-right-style:none;border-left-style:none;">
	                                                     <apex:outputText value="Quantity" />
	                                                 </td>
	                                             </tr>
	                                              <tr>
	                                                 <td style="height:35px;width:200px;border-right-style:none;border-left-style:none;border-bottom-style:none">
	                                                     <apex:outputText value="Revenue" />
	                                                </td>
	                                             </tr>
	                                     <!--         
	                                             <tr>
	                                                 <td style="height:22px;width:200px;border-right-style:none;border-left-style:none;">
	                                                     <apex:outputText value="Remove" />
	                                                </td>
	                                             </tr>
	                                      -->                                                     
	                                         </table>
	                                     </td>
	                                     <apex:repeat id="table1" value="{!listOfRevenueForcastRecords}" var="forcast">
	                                         <!-- <apex:variable var="positioncount" value="{!positioncount+1}"/> -->
	                                         <td class="outerTd" style="text-align:center;">
	                                             <table id="innerTable">
	                                                 <tr>
	                                                     <!--<td style="text-align:center;height:15px;border-right-style:none;border-top-style:none;background-color:#ececec;background-repeat: repeat-x">
	                                                         <apex:inputField value="{!forcast.Year__c}"/>                                    
	                                                     </td>-->
	                                                     <td style="text-align:center;height:17px;border-right-style:none;border-top-style:none;background-color:#ececec;background-repeat: repeat-x">
	                                                         <apex:outputField value="{!forcast.Year__c}" style="text-align:right;width:100px;"/>                                    
	                                                     </td>
	                                                 </tr>
	                                                 <tr>
	                                                     <td style="text-align:center;height:23px;">
	                                                         <apex:inputField value="{!forcast.Average_Sales_Price__c}" style="text-align:right;width:100px;"/>
	                                                     </td>
	                                                 </tr>
	                                                 <tr>                                                         
	                                                     <td style="text-align:center;height:28px;">
	                                                         <apex:inputField value="{!forcast.Quantity__c}" style="text-align:right;width:100px;"/>
	                                                     </td>
	                                                 </tr>
	                                                   <tr>
	                                                     <td style="text-align:center;height:35px;border-bottom-style:none;border-right-style:none;">
	                                                         <apex:inputField value="{!forcast.Revenue__c}" style="text-align:right;width:100px;"/>
	                                                     </td>
	                                                 </tr>
	                                        <!-- 
	                                                 <tr>
	                                                    <td>
	                                                          
	                                                        <apex:image value="{!$Resource.GMPL_RemoveIcon}" 
	                                                                    title="Remove Record" 
	                                                                    onclick="return confirmRowRemoveAction('{!positioncount}');">
	                                                        </apex:image>
	                                                        
	                                                    </td>
	                                                 </tr>      
	                                        -->                                                             
	                                             </table>                                            
	                                         </td>
	                                    </apex:repeat>  
	                                </tr>
	                            </table>
	                    </div>
       				</apex:outputPanel>
                <apex:pageBlockButtons location="both">
                    <apex:commandButton action="{!SaverevenueForcastingInfo}" value="Save" rendered="{!isEditable}"/>
                    <apex:commandButton value="Cancel" action="{!cancel}"/>
                    <apex:commandButton value="Add Year" action="{!addNewRow}" reRender="pageBlockId" rendered="{!isEditable}"/>
                    <apex:commandButton value="Delete Last Year" onclick="confirmRowRemoveAction();return false;" rendered="{!isEditable}"/>
                    <apex:actionFunction name="delLastYear" action="{!deleteLastYear}" rendered="{!isEditable}" reRender="pageBlockId" oncomplete="unblockPage();"/>
                </apex:pageBlockButtons>
                
                <apex:inputHidden value="{!rowIndex}" id="hiddenId"/>                   
                
          </apex:pageBlock>
          
        </apex:form>
        
        <script>
            function confirmRowRemoveAction(){
                  /*document.getElementById("pageId:formId:pageBlockId:hiddenId").value=rowIndex;
                  var result = confirm('Do you want to remove this record ?');
                  if (result){*/
                    blockPage();
                    delLastYear();
                  /*} else {
                    return false;
                  }*/
            } 
            
            function unblockPage(){  
                $.unblockUI();  
            } 
            
            function blockPage(){   
               $.blockUI({ message: '<img src="/img/loading32.gif" /><h1> Work In Progress..Please Wait..</h1>',   
                                css: {   
                                     border: 'none',   
                                     padding: '15px',   
                                     '-webkit-border-radius': '10px',   
                                     '-moz-border-radius': '10px',   
                                     opacity: .9  
                                 }   
               });   
                return false;  
            } 
         
        </script>
        
</apex:page>