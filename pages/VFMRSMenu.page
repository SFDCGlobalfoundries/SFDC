<!--
 Type Name: VFMRSMenu
 Author: Cognizant Technology Solutions
 Created Date: 24-April-2014
 Modified Date: 
 Reason: This class is responsible for showing the MRS Menu for Internal user.
 Change History:
 Author: 
 Modified Date: 
 Reason: 
 ��.. 
 ��..
-->

<apex:page sidebar="false" id="mrsMenuId" controller="MRSMenuExtn">
    <!---------------------------------------------------     StyleSheet    -------------------------------------------------------------->
    <apex:stylesheet value="{!URLFOR($Resource.NewFV2Styles, 'NewFV2Styles/css/style.css')}" id="stylesheet_location"/> 
    <apex:stylesheet value="{!URLFOR($Resource.SWIFT_MYDEVICE, 'css/style.css')}" /> 
    <!------------------------------------------------------------------------------------------------------------------------------------>
    <!-------------------------------------------------     JS File   ------------------------------------------------------------------>
    <apex:includeScript value="{!URLFOR($Resource.NewFV2Styles, 'NewFV2Styles/js/jquery.min.js')}" id="jqueryminjs_location"/>
    <apex:includeScript value="{!URLFOR($Resource.NewFV2Styles, 'NewFV2Styles/js/leftmenu.js')}" id="leftmenujs_location"/>
    <apex:includeScript value="{!URLFOR($Resource.SWIFT_MYDEVICE, 'js/leftmenu.js')}" /> 
    <!------------------------------------------------------------------------------------------------------------------------------------>
    <style>
        #content {
            float:left;
        }
        .use-sidebar #leftpanel {
            width:18%;
            min-width:18%;
        }
        .right-panel-section {
            min-height:770px;
        }
    </style> 
    <apex:form id="myform">    
        <div id="wrapper">
            <div id="container" class="use-sidebar ">
                <div id="leftpanel">
                    <div id="leftmenu">
                        <ul id="nav" class="leftnav">
                          <apex:outputLabel >
                            <li> <a href="#" class="open" id="mrs">MRS</a>
                                <ul class="selected-underscore" style="display:none;">
                                   <apex:outputLabel >
                                    <li><a href="#" onclick="OpenPage('Layer Summary'); return false;">Layer Summary</a></li>
                                   </apex:outputLabel>
                                    <apex:outputLabel rendered="{!IF(showGDSOUTReviewLink || showFoundryGDSOUTReview,true,false)}">
                                    <li><a href="#">GDSOUT Review</a>
                                        <ul class="selected-underscore">
                                           <apex:outputLabel rendered="{!IF(showGDSOUTReviewLink,true,false)}">
                                            <li><a href="#" onclick="OpenPage('GDSOUTReview-Customer'); return false;">Customer</a></li>
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="{!IF(showFoundryGDSOUTReview,true,false)}">
                                            <li><a href="#" onclick="OpenPage('GDSOUTReview-Foundry'); return false;">Foundry</a></li> 
                                           </apex:outputLabel>
                                        </ul> 
                                    </li>
                                   </apex:outputLabel>
                                   <apex:outputLabel rendered="{!IF(showFrameMockupLink || showFoundryFrameMockupLink,true,false)}">
                                    <li><a href="#" class="frameMockupLegth">Frame Mockup Review</a>
                                        <ul class="selected-underscore">
                                           <apex:outputLabel rendered="{!IF(showFrameMockupLink,true,false)}">
                                            <li><a href="#" onclick="OpenPage('FrameMockupReview-Customer'); return false;">Customer</a></li>
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="{!IF(showFoundryFrameMockupLink,true,false)}">
                                            <li><a href="#" onclick="OpenPage('FrameMockupReview-Foundry'); return false;">Foundry</a></li> 
                                            </apex:outputLabel>
                                        </ul> 
                                    </li>
                                   </apex:outputLabel>
                                   <apex:outputLabel rendered="{!IF(showSendData || showPrimeSendData || showFrameSendData,true,false)}">
                                    <li><a href="#">Send Data</a>
                                        <ul class="selected-underscore">
                                           <apex:outputLabel rendered="{!IF(showPrimeSendData,true,false)}">
                                            <li><a href="#" onclick="OpenPage('SendData-Prime'); return false;">Prime</a></li>
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="{!IF(showFrameSendData,true,false)}">
                                            <li><a href="#" onclick="OpenPage('SendData-Frame'); return false;">Frame</a></li> 
                                           </apex:outputLabel>
                                        </ul> 
                                    </li>
                                   </apex:outputLabel>
                                   <apex:outputLabel rendered="{!IF(showMEBBESLink 
                                                                    || showFoundryMEBBESReviewLink 
                                                                    || showTapeOutCenterReviewLink 
                                                                    || showTapeOutApplicationReviewLink 
                                                                    || showGlobalShuttleReviewLINK 
                                                                    || showMDPReviewLink,true,false )}">
                                                                    
                                                                    <!-- swgp-1076: removed tdti-mpw -->
                                                                    <!--  || showTDTIReviewLink,true,false)}"> -->
                                                                    
                                                                    
                                    <li><a href="#">MEBES Jobview</a>
                                        <ul class="selected-underscore">
                                           <apex:outputLabel rendered="{!IF(showMEBBESLink,true,false)}">
                                            <li><a href="#" onclick="OpenPage('MEBESJobview-Customer'); return false;">Customer</a></li>
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="{!IF(showFoundryMEBBESReviewLink,true,false)}">
                                            <li><a href="#" onclick="OpenPage('MEBESJobview-Foundry'); return false;">Foundry</a></li>
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="{!IF(showTapeOutCenterReviewLink,true,false)}">
                                            <li><a href="#" onclick="OpenPage('MEBESJobview-TapeoutCentre'); return false;">Tapeout Centre</a></li>
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="{!IF(showTapeOutApplicationReviewLink,true,false)}">
                                            <li><a href="#" onclick="OpenPage('MEBESJobview-TapeoutApp'); return false;">Tapeout Application</a></li>
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="{!IF(showGlobalShuttleReviewLINK,true,false)}">
                                            <li><a href="#" onclick="OpenPage('MEBESJobview-GlobalShuttle'); return false;">Global Shuttle</a></li>
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="{!IF(showMDPReviewLink,true,false)}">
                                            <!-- TASK-2479 -->
                                            <!--
                                            <li><a href="#" onclick="OpenPage('MEBESJobview-MDP'); return false;">MDP</a></li>
                                            -->
                                            <li><a href="#" onclick="OpenPage('MEBESJobview-MDP'); return false;">DRR</a></li>
                                            <!-- TASK-2479 END -->
                                           </apex:outputLabel>
                                           <apex:outputLabel rendered="false"><!-- swgp-1076: removed tdti-mpw -->
                                            <li><a href="#" onclick="OpenPage('MEBESJobview-MPWTDTI'); return false;">TDTI-MPW</a></li>
                                           </apex:outputLabel> 
                                        </ul> 
                                    </li>
                                   </apex:outputLabel>
                                   <apex:outputLabel rendered="{!showHoldResumeButton}">
                                    <li><a href="#" onclick="OpenPage('Hole/Resume Layer'); return false;">Hold/Resume Layer</a></li> 
                                   </apex:outputLabel>              
                                </ul>
                            </li>  
                           </apex:outputLabel>            
                        </ul>
                    </div>
                    <a href="#" id="separator" style="height: 537px;"></a>
                </div>
                
                <!-- Start of Right side content-->
                <div id="content">
                    <apex:pageBlock id="mainpb">
                        <apex:outputPanel rendered="true" id="detailpb">
                            <apex:image url="{!URLFOR($Resource.NewFV2Styles,'NewFV2Styles/images/GF_Devices-thumbnail.png')}" width="30px" height="30px" id="subject_image"/>
                            <apex:outputLabel value="{!respectiveLevel}" id="label" style="position:absolute;vertical-align:bottom;font-size:17px;font-style:normal;margin-top:10px"/>
                            <hr color="#ccced0" size="1" width="100%"/>
                            <apex:iframe width="100%" height="800px" src="{!OpenPageURL}" scrolling="false" id="frameSwift"/>
                        </apex:outputPanel>
                    </apex:pageBlock>
                </div>
            </div>
        </div>
        <apex:actionFunction action="{!redirect}" name="OpenPage" reRender="label,mainpb,welcomepb,detailpb,frame">
            <apex:param assignTo="{!Page}" value="" name="param1"/>
        </apex:actionFunction> 
        <apex:inputHidden id="parameterId" value="{!parameter}"/>
        
    </apex:form>
    <script type="text/javascript"> 
        function getFrameMiddleHeight() {
            var gh = 255;
            var h = jQuery(window).scrollTop()-gh+(jQuery(window).height()/2);
            h = (h<120)?120:h;
            return h;
        }
        function iframeLoaded() {
          var iFrameID = document.getElementById('frameSwift');
          if(iFrameID) {
              iFrameID.height = "";
              iFrameID.height = iFrameID.contentWindow.document.body.scrollHeight+50 + "px";
          }   
        }
        function openNode(links){
           
            jQuery('#mrs').trigger('click');    
            var subMenu = $('#mrs').siblings("ul").find("label").eq(links[0]);
            if((subMenu != null) && (subMenu.length>0)) {
                jQuery(subMenu).find("a").eq(0).trigger('click');                
                var leafNode=jQuery(subMenu).find("a").eq(0).siblings("ul").find("label").eq(links[1]);
                if((leafNode != null) && (leafNode.length>0)) {
                    jQuery(leafNode).trigger('click');
                }
            }
        }
        jQuery(document).ready(function() {
            var links;
            var url = document.URL;
            var openLink = false;
            var pos = 0;
            if((pos = url.search(/iframe=VFMRSLayerSummary/i)) != -1) {
                links = [0];
                var paramIndex = pos+'iframe=VFMRSLayerSummary'.length+1;
                var iframeParam = url.substring(paramIndex);                
                jQuery('[id$="hiddenIframeParam"]').prop('value',iframeParam);
                openLink = true;
            }
            else if((pos = url.search(/iframe=VFMRSGDSOUTReview/i)) != -1) {
                links = [1,0];
                var paramIndex = pos+'iframe=VFMRSGDSOUTReview'.length+1;
                var iframeParam = url.substring(paramIndex);                
                jQuery('[id$="hiddenIframeParam"]').prop('value',iframeParam);
                document.getElementById('mrsMenuId:myform:parameterId').value = url;
                //alert('%%%'+ document.getElementById('mrsMenuId:myform:parameterId').value);
                //openLink = true;
                OpenPage("GDSOUTReview-Foundry");
            }
            else if((pos = url.search(/iframe=VFMRSFrameMockupReview/i)) != -1) {
                links = [6,1];
                var paramIndex = pos+'iframe=VFMRSFrameMockupReview'.length+1;
                var iframeParam = url.substring(paramIndex);                
                jQuery('[id$="hiddenIframeParam"]').prop('value',iframeParam);
               // openLink = true;
                //alert('%%%'+ url);
                document.getElementById('mrsMenuId:myform:parameterId').value = url;
                OpenPage("FrameMockupReview-Foundry");
            }
            else if((pos = url.search(/iframe=VFMRSMEBESJobview/i)) != -1) {
                
                var paramIndex = pos+'iframe=VFMRSMEBESJobview'.length+1;
                var iframeParam = url.substring(paramIndex);
                
                document.getElementById('mrsMenuId:myform:parameterId').value = url;
                if(url.indexOf('jobview=Foundry') != -1){
                    links = [12,1];
                    //openLink = true;
                    OpenPage("MEBESJobview-Foundry");
                }else if(url.indexOf('jobview=TapeoutCentre') != -1){
                    links = [13,1];
                    //openLink = true;
                    OpenPage("MEBESJobview-TapeoutCentre");
                }else if(url.indexOf('jobview=TapeoutApp') != -1){
                    links = [14,1];
                    //openLink = true;
                    OpenPage("MEBESJobview-TapeoutApp");
                }else if(url.indexOf('jobview=GlobalShuttle') != -1){
                    links = [15,1];
                    //openLink = true;
                    OpenPage("MEBESJobview-GlobalShuttle");
                }else if(url.indexOf('jobview=MDP') != -1){
                    links = [16,1];
                    //openLink = true;
                    OpenPage("MEBESJobview-MDP");
                }else if(url.indexOf('jobview=MPWTDTI') != -1){
                    links = [17,1];
                    //openLink = true;
                    OpenPage("MEBESJobview-MPWTDTI");
                }      
                           
                jQuery('[id$="hiddenIframeParam"]').prop('value',iframeParam);
            }
            if(openLink) {
                openNode(links);
            }
        });
    </script>
</apex:page>