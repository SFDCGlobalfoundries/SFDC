<!-------------------------------------------------------------------------------------------------------------
        Type Name: BX041_ProcessInfoPDF.page
        Author: Prosenjit Saha and Thomas Lai
        Created Date: 
        Reason: The page is used to display the PDF or Excel format of the process information section of the BX041 form.
        Change History:
        Author: 
        Modified Date: 
        Reason:
---------------------------------------------------------------------------------------------------------------->


<apex:page standardController="BX_041__c" extensions="BX041_processInfoPDF" sidebar="False" showHeader="False">
    <apex:form >
    
    <!----------------- script section to generate the print verison ----------------------------->
    <script>
         //window.print();

         window.onload = function () {
         window.setTimeout(function () {
             window.print();
         }, 5);
         }

     //window.close();
 
    </script>
    <!----------------- script section to generate the print verison ends ----------------------------->
        
        <apex:pageBlock title="New CDRS">
            <!-------------- start: page block to generate the BX041 header information -------------------->                       
            <apex:pageBlockSection collapsible="true" title="Information" columns="1">
                <apex:outputField value="{!bx041.Device__c}"/>
                <apex:outputField value="{!bx041.BX_041_Status__c}"/>
                <apex:outputField value="{!bx041.CRMDID_Fromula__c}"/>
                <apex:outputField value="{!bx041.Opportunity_Program__c}"/>             
            </apex:pageBlockSection>  
            <!-------------- End: page block to generate the BX041 header information --------------------> 
            
            <!-------------- start: page block to generate the process information section -------------------->
            <apex:pageblockSection collapsible="true" title="Process Information" >
                <apex:pageBlockTable value="{!ListWrapper}" var="wrap">
                    <apex:column value="{!wrap.question}" headervalue="Questions"/>
                    <apex:column value="{!wrap.value}" headerValue="Customer Request"/>
                    <apex:column value="{!wrap.FEinfo}" headerValue="FE"/>
                    <apex:column value="{!wrap.PiyeInfo}" headerValue="PIYE"/>
                    <apex:column value="{!wrap.comments}" headervalue="Customer Comments"/>
                </apex:pageBlockTable>    
            </apex:pageblockSection>    
            <!-------------- End: page block to generate the process information section --------------------> 
        </apex:pageBlock>
    </apex:form>
</apex:page> <!--END OF THE PAGE ---->