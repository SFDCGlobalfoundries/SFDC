<apex:page standardController="MRS_Layer_Association__c" extensions="MRSLayerSummaryExtn" showHeader="false" sideBar="false" standardStylesheets="false" contentType="application/vnd.ms-excel#LayerSummary.xls" cache="true">
<apex:form >
    <table>
                <tr align="center"><td colspan="5"><h2><u>Layer Summary</u></h2></td></tr>     
   </table>
    <br/>
    <table cellspacing="5">         
           <tr> 
             <td style="font-weight:bold;">Customer Name:</td>
             <td>{!selectedCustomerName}</td>
           </tr>
           <apex:outputLabel >
             <tr>
               <td style="font-weight:bold;">Mask Set Title:</td>
               <td>{!selectedmst}</td>
             </tr>
           </apex:outputLabel>          
           <apex:outputLabel rendered="{!IF(LayerStatusForExport != null && LayerStatusForExport != '',true,false)}">
             <tr>
               <td style="font-weight:bold;">Layer Status:</td>
               <td>{!IF(LayerStatusForExport != null,LayerStatusForExport,'')}</td>
             </tr>
           </apex:outputLabel>
           <apex:outputLabel rendered="{!IF(SelectedMaskLayerValue != null && SelectedMaskLayerValue != '',true,false)}">
             <tr>
               <td style="font-weight:bold;">Mask Layer:</td>
               <td>{!IF(SelectedMaskLayerValue != null,SelectedMaskLayerValue,'')}</td>
             </tr>
           </apex:outputLabel>
           <apex:outputLabel rendered="{!IF(SelectedDeviceIdValue != null && SelectedDeviceIdValue != '',true,false)}">
             <tr>
               <td style="font-weight:bold;">Device ID:</td>
               <td>{!IF(SelectedDeviceIdValue != null,SelectedDeviceIdValue,'')}</td>
             </tr>
           </apex:outputLabel>
           <apex:outputLabel rendered="{!IF(SelectedTechGeoStatusValue != null && SelectedTechGeoStatusValue != '',true,false)}">
             <tr>
               <td style="font-weight:bold;">Tech Geo:</td>
               <td>{!IF(SelectedTechGeoStatusValue != null,FormattedTechGeo,'')}</td>
             </tr>
           </apex:outputLabel>                                 
    </table> 
    <br/>
    <table style="border:1px solid #000;" cellspacing="0" cellpadding="2" border="1">
        <thead style="background:#e3e3e3;">        
            <tr style="height:45px;">
               <apex:outputLabel style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>No.</strong></span></th></apex:outputLabel> 
               <apex:outputLabel style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Mask Layer (ROM Code)</strong></span></th></apex:outputLabel>
               <apex:outputLabel style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Layer Status</strong></span></th></apex:outputLabel>
                  <apex:outputLabel rendered="{!TechGeoDisplayFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Tech Geo</strong></span></th></apex:outputLabel>
                  <apex:outputLabel rendered="{!GDSOUTReviewCustomerFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>GDSOUT Review</strong> Customer</span></th></apex:outputLabel>
                  <apex:outputLabel rendered="{!GDSOUTReviewFoundryFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>GDSOUT Review</strong> Foundry</span></th></apex:outputLabel>
                  <apex:outputLabel rendered="{!FrameMockupCustomerFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Frame<br/> Mockup Review</strong> Customer</span></th></apex:outputLabel>
                  <apex:outputLabel rendered="{!FrameMockupFoundryFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Frame<br/> Mockup Review</strong> Foundry</span></th></apex:outputLabel>
                  <apex:outputLabel rendered="{!SendDataPrimeFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Send Data</strong> Prime</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!SendDataFrameFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Send Data</strong> Frame</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!ORCFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>ORC</strong></span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!DRWFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>DRW</strong></span></th></apex:outputLabel>                  
                  <apex:outputLabel rendered="{!CustomerRemoteJobviewPrimeFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Customer Remote Jobview</strong> Prime</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!CustomerRemoteJobviewFrameFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Customer Remote Jobview</strong> Frame</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!FoundryRemoteJobviewPrime}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Foundry<br/> Remote Jobview</strong> Prime</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!FoundryRemoteJobviewFrame}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>Foundry<br/> Remote Jobview</strong> Frame</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESReceivedPrimeFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>MEBES<br/> Received</strong> Prime</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESReceivedFrameFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>MEBES<br/> Received</strong> Frame</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESJobviewCustomerFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>MEBES<br/> Jobview</strong> Customer</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESJobviewFoundryFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>MEBES<br/> Jobview</strong> Foundry</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESJobviewTapeoutCentreFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>MEBES<br/> Jobview</strong> Tapeout Centre</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESJobviewTapeoutApplicationsFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>MEBES<br/> Jobview <br/></strong> Tapeout Applications</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESJobviewGlobalShuttleFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>MEBES<br/> Jobview</strong> GlobalShuttle</span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESJobviewMDPFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong><br/>DRR</strong></span></th></apex:outputLabel> 
                  <apex:outputLabel rendered="{!MEBESJobviewTDTIMPWFlag}" style="border:0px solid #ccc; border-left:0;align:left"><th><span><strong>MEBES<br/> Jobview<br/></strong> TDTI-MPW</span></th></apex:outputLabel>                    
            </tr>           
        </thead>
        <tbody>
         <apex:variable value="{!1}" var="counter"/>    
            <apex:repeat value="{!MasterData}" var="MRSLayer">
                <tr>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left"><td>{!counter}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left"><td>{!MRSLayer.OrigObj.Name}{!MRSLayer.OrigObj.Mask_Layer_Rev__c}{!if(MRSLayer.OrigObj.ROM_Code__c != '' && MRSLayer.OrigObj.ROM_Code__c != 'NULL' && MRSLayer.OrigObj.ROM_Code__c != '####',(BLANKVALUE('('+MRSLayer.OrigObj.ROM_Code__c+')','')),'')}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left"><td>{!MRSLayer.OrigObj.Layer_Status__c}</td></apex:outputLabel> 
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!TechGeoDisplayFlag}"><td>{!if(MRSLayer.OrigObj.Tech_Geo__c != 'NULL',MRSLayer.OrigObj.Tech_Geo__c,'')}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!GDSOUTReviewCustomerFlag}"><td>{!MRSLayer.OrigObj.Customer_GDSOUT_Review__c}</td></apex:outputLabel>                                
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!GDSOUTReviewFoundryFlag}"><td>{!MRSLayer.OrigObj.Foundry_GDSOUT_Review__c}</td></apex:outputLabel>              
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!FrameMockupCustomerFlag}"><td>{!MRSLayer.OrigObj.Customer_Frame_Mockup__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!FrameMockupFoundryFlag}"><td>{!MRSLayer.OrigObj.Foundry_Frame_Mockup__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!SendDataPrimeFlag}"><td>{!MRSLayer.OrigObj.Send_Prime_Data__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!SendDataFrameFlag}"><td>{!MRSLayer.OrigObj.Send_Frame_Data__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!ORCFlag}"><td>{!MRSLayer.OrigObj.ORC__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!DRWFlag}"><td>{!MRSLayer.OrigObj.DRW__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!CustomerRemoteJobviewPrimeFlag}"><td>{!MRSLayer.OrigObj.Customer_Prime_Remote_Jobview_Setup__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!CustomerRemoteJobviewFrameFlag}"><td>{!MRSLayer.OrigObj.Customer_Frame_Remote_Jobview_Setup__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!FoundryRemoteJobviewPrime}"><td>{!MRSLayer.OrigObj.Foundry_Prime_Remote_Jobview_Setup__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!FoundryRemoteJobviewFrame}"><td>{!MRSLayer.OrigObj.Foundry_Frame_Remote_Jobview_Setup__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESReceivedPrimeFlag}"><td>{!MRSLayer.OrigObj.Prime_MEBES_Received__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESReceivedFrameFlag}"><td>{!MRSLayer.OrigObj.Frame_MEBES_Received__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESJobviewCustomerFlag}"><td>{!MRSLayer.OrigObj.Customer_MEBES_Jobview__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESJobviewFoundryFlag}"><td>{!MRSLayer.OrigObj.Foundry_MEBES_Jobview__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESJobviewTapeoutCentreFlag}"><td>{!MRSLayer.OrigObj.Tapeout_Centre_MEBES_Jobview__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESJobviewTapeoutApplicationsFlag}"><td>{!MRSLayer.OrigObj.Tapeout_Applications_MEBES_Jobview__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESJobviewGlobalShuttleFlag}"><td>{!MRSLayer.OrigObj.GlobalShuttle_MEBES_Jobview__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESJobviewMDPFlag}"><td>{!MRSLayer.OrigObj.MDP_MEBES_Jobview__c}</td></apex:outputLabel>
                    <apex:outputLabel style="border-right:0px solid #ccc; border-left:0;align:left" rendered="{!MEBESJobviewTDTIMPWFlag}"><td>{!MRSLayer.OrigObj.TDTI_MPW_MEBES_Jobview__c}</td></apex:outputLabel>
                </tr>
                 <apex:variable value="{!counter+1}" var="counter"/>
            </apex:repeat>
        </tbody>
    </table>     
</apex:form>
</apex:page>