<apex:page standardController="MRS_Layer_Association__c" extensions="MRSLayerChipSummaryExtn" showHeader="false" sideBar="false" standardStylesheets="false" contentType="application/vnd.ms-excel#LayerChipSummary.csv" cache="true" language="en-US">
         <apex:variable value="{!1}" var="counter"/>
    
    Layer Chip Summary
    Customer Name:,{!strCustomerName},
    Mask Set Title:,{!objLayerSummaryDetails.Mask_Set_Title_Name__c},,Mask Layer:,{!objLayerSummaryDetails.name}{!objLayerSummaryDetails.Mask_Layer_Rev__c}{!if(objLayerSummaryDetails.ROM_Code__c != '' && objLayerSummaryDetails.ROM_Code__c != '####','('+objLayerSummaryDetails.ROM_Code__c+')','')},
    {!IF(strSelectedLayerChipStatus!=null && strSelectedLayerChipStatus!='','Layer Chip Status: ,'+strSelectedLayerChipStatus,'')}
    {!IF(deviceSelectedValue!=null && deviceSelectedValue!='','Device ID: ,'+deviceSelectedValue,'')}
    {!IF(ptrfSelectedValue!=null && ptrfSelectedValue!='','PTRF/DRT Number: ,'+ptrfSelectedValue,'')}
    {!IF(techgeoSelectedValue!=null && techgeoSelectedValue!='','Tech Geo: ,'+techgeoSelectedText,'')}
    
    Selected Layer Details
    
    No.,Mask Layer(ROM Code),Layer Status,{!IF(boolShowTechGeo,'Tech Geo,',',')}GDSOUT Review Customer,GDSOUT Review Foundry,Frame Mockup Review Customer,Frame Mockup Review Foundry,Send Data Prime,Send Data Frame,ORC,DRW,Customer Remote Jobview Prime,Customer Remote Jobview Frame,Foundry Remote Jobview Prime,Foundry Remote Jobview Frame,MEBES Received Prime,MEBES Received Frame,MEBES Jobview Customer,MEBES Jobview Foundry,MEBES Jobview Tapeout Centre,MEBES Jobview Tapeout Applications,MEBES Jobview GlobalShuttle,DRR,MEBES Jobview TDTI-MPW
    1,{!objLayerSummaryDetails.name}{!objLayerSummaryDetails.Mask_Layer_Rev__c}{!if(objLayerSummaryDetails.ROM_Code__c != '' && objLayerSummaryDetails.ROM_Code__c != '####','('+objLayerSummaryDetails.ROM_Code__c+')','')},{!objLayerSummaryDetails.Layer_Status__c},{!IF(boolShowTechGeo,strTechGeo,'')},{!objLayerSummaryDetails.Customer_GDSOUT_Review__c},{!objLayerSummaryDetails.Foundry_GDSOUT_Review__c},{!objLayerSummaryDetails.Customer_Frame_Mockup__c},{!objLayerSummaryDetails.Foundry_Frame_Mockup__c},{!objLayerSummaryDetails.Send_Prime_Data__c},{!objLayerSummaryDetails.Send_Frame_Data__c},{!objLayerSummaryDetails.ORC__c},{!objLayerSummaryDetails.DRW__c},{!objLayerSummaryDetails.Customer_Prime_Remote_Jobview_Setup__c},{!objLayerSummaryDetails.Customer_Frame_Remote_Jobview_Setup__c},{!objLayerSummaryDetails.Foundry_Prime_Remote_Jobview_Setup__c},{!objLayerSummaryDetails.Foundry_Frame_Remote_Jobview_Setup__c},{!objLayerSummaryDetails.Prime_MEBES_Received__c},{!objLayerSummaryDetails.Frame_MEBES_Received__c},{!objLayerSummaryDetails.Customer_MEBES_Jobview__c},{!objLayerSummaryDetails.Foundry_MEBES_Jobview__c},{!objLayerSummaryDetails.Tapeout_Centre_MEBES_Jobview__c},{!objLayerSummaryDetails.Tapeout_Applications_MEBES_Jobview__c},{!objLayerSummaryDetails.GlobalShuttle_MEBES_Jobview__c},{!objLayerSummaryDetails.MDP_MEBES_Jobview__c},{!objLayerSummaryDetails.TDTI_MPW_MEBES_Jobview__c}

    Layer Chip Summary
    
    No.,Chip,PTRF/DRT Number,Layer Chip Status,GDSOUT Review Customer,GDSOUT Review Foundry,Frame Mockup Review Customer,Frame Mockup Review Foundry,Send Data Prime,Send Data Frame,ORC,DRW,Customer Remote Jobview Prime,Customer Remote Jobview Frame,Foundry Remote Jobview Prime,Foundry Remote Jobview Frame,MEBES Received Prime,MEBES Received Frame,MEBES Jobview Customer,MEBES Jobview Foundry,MEBES Jobview Tapeout Centre,MEBES Jobview Tapeout Applications,MEBES Jobview GlobalShuttle,DRR,MEBES Jobview TDTI-MPW
    <apex:variable value="{!1}" var="counter"/>
    <apex:repeat value="{!lstLayerChipSummary}" var="objWrapper">
    {!counter},{!objWrapper.Chip_Name__c},{!objWrapper.PTRF_Or_DRT__c},{!objWrapper.Layer_Chip_Status__c},{!objWrapper.Customer_GDSOUT_Review__c},{!objWrapper.Foundry_GDSOUT_Review__c},{!objWrapper.Customer_Frame_Mockup__c},{!objWrapper.Foundry_Frame_Mockup__c},{!objWrapper.Send_Prime_Data__c},{!objWrapper.Send_Frame_Data__c},{!objWrapper.ORC__c},{!objWrapper.DRW__c},{!objWrapper.Customer_Prime_Remote_Jobview_Setup__c},{!objWrapper.Customer_Frame_Remote_Jobview_Setup__c},{!objWrapper.Foundry_Prime_Remote_Jobview_Setup__c},{!objWrapper.Foundry_Frame_Remote_Jobview_Setup__c},{!objWrapper.Prime_MEBES_Received__c},{!objWrapper.Frame_MEBES_Received__c},{!objWrapper.Customer_MEBES_Jobview__c},{!objWrapper.Foundry_MEBES_Jobview__c},{!objWrapper.Tapeout_Centre_MEBES_Jobview__c},{!objWrapper.Tapeout_Applications_MEBES_Jobview__c},{!objWrapper.GlobalShuttle_MEBES_Jobview__c},{!objWrapper.MDP_MEBES_Jobview__c},{!objWrapper.TDTI_MPW_MEBES_Jobview__c}
    <apex:variable value="{!counter+1}" var="counter"/>
    </apex:repeat>
    
</apex:page>