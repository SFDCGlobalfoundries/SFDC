<apex:page standardController="Device__c" extensions="PSP_MilestoneExtension" action="{!fetchArchieves}" showChat="false" sidebar="false" tabStyle="Device__c">
  <apex:pageBlock >
      <apex:pagemessages id="statusmsg"/>
      <apex:pageblockTable value="{!archieveList}" var="arch">
          <apex:column headerValue="Status Name">
              <!-- apex:outputLink value="/{!arch.Id}" target="blank">{!arch.Name}</apex:outputLink -->
              <apex:outputLink value="javascript:sendoldStatusData('{!arch.Risk__c}','{!arch.Overview_Comments__c}','{!arch.Escalation__c}','{!arch.Who__c}','{!arch.When__c}');" onclick="window.close();">{!arch.Name}</apex:outputLink>
              <script>
                  function sendoldStatusData(risk,comment,escalation,who,when){
                      var newWhen;
                      if(when != ''){
                          var whenpart = when.split('/');
                          newWhen = whenpart[2]+'-'+ whenpart[0] + '-' + whenpart[1];
                      }
                      top.opener.document.getElementById('devMilestone:form1:pb1:statRisk').value = risk; 
                      top.opener.document.getElementById('devMilestone:form1:pb1:statCommentInput').value = comment;
                      top.opener.document.getElementById('devMilestone:form1:pb1:statEsc').value = escalation;
                      top.opener.document.getElementById('devMilestone:form1:pb1:statWho').value = who;
                      top.opener.document.getElementById('devMilestone:form1:pb1:statWhen').value = newWhen;
                      window.close();                                  
                  }
              </script>
          </apex:column>
          <apex:column value="{!arch.Risk__c}"/>
          <apex:column value="{!arch.Overview_Comments__c}"/>
          <apex:column value="{!arch.Escalation__c}"/>
          <apex:column value="{!arch.Who__c}"/>
          <apex:column value="{!arch.When__c}"/>
          <apex:column headerValue="Created By" value="{!arch.CreatedBy.Name}"/>
          <apex:column headerValue="Created Date/Time" value="{!arch.CreatedDate}"/>
      </apex:pageblockTable>
  </apex:pageBlock>
</apex:page>