<apex:page standardController="MRS_Layer_Association__c" extensions="MRSLayerSummaryExtn" showHeader="false" sideBar="false" standardStylesheets="false" contentType="application/vnd.ms-excel#LayerSummary.csv" cache="true" language="en-US">
         <apex:variable value="{!1}" var="counter"/>
    Layer Summary
    
    Customer Name:,{!selectedCustomerName},
    Mask Set Title:,{!selectedmst},
    {!IF(LayerStatusForExport != null && LayerStatusForExport != '','Layer Status: ,'+'\"'+LayerStatusForExport+'\"','')}   
    {!IF(SelectedMaskLayerValue != null && SelectedMaskLayerValue != '','Mask Layer: ,'+SelectedMaskLayerValue,'')} 
    {!IF(SelectedDeviceIdValue != null && SelectedDeviceIdValue != '','Device ID: ,'+SelectedDeviceIdValue,'')}    
    {!IF(SelectedTechGeoStatusValue != null && SelectedTechGeoStatusValue != '','Tech Geo: ,'+FormattedTechGeo,'')}      
    No.,Mask Layer(ROM Code),Layer Status,{!IF(TechGeoDisplayFlag,'Tech Geo,','')}{!IF(GDSOUTReviewCustomerFlag,'GDSOUT Review Customer,','')}{!IF(GDSOUTReviewFoundryFlag,'GDSOUT Review Foundry,','')}{!IF(FrameMockupCustomerFlag,'Frame Mockup Review Customer,','')}{!IF(FrameMockupFoundryFlag,'Frame Mockup Review Foundry,','')}{!IF(SendDataPrimeFlag,'Send Data Prime,','')}{!IF(SendDataFrameFlag,'Send Data Frame,','')}{!IF(ORCFlag,'ORC,','')}{!IF(DRWFlag,'DRW,','')}{!IF(CustomerRemoteJobviewPrimeFlag,'Customer Remote Jobview Prime,','')}{!IF(CustomerRemoteJobviewFrameFlag,'Customer Remote Jobview Frame,','')}{!IF(FoundryRemoteJobviewPrime,'Foundry Remote Jobview Prime,','')}{!IF(FoundryRemoteJobviewFrame,'Foundry Remote Jobview Frame,','')}{!IF(MEBESReceivedPrimeFlag,'MEBES Received Prime,','')}{!IF(MEBESReceivedFrameFlag,'MEBES Received Frame,','')}{!IF(MEBESJobviewCustomerFlag,'MEBES Jobview Customer,','')}{!IF(MEBESJobviewFoundryFlag,'MEBES Jobview Foundry,','')}{!IF(MEBESJobviewTapeoutCentreFlag,'MEBES Jobview Tapeout Centre,','')}{!IF(MEBESJobviewTapeoutApplicationsFlag,'MEBES Jobview  Tapeout Applications,','')}{!IF(MEBESJobviewGlobalShuttleFlag,'MEBES Jobview GlobalShuttle,','')}{!IF(MEBESJobviewMDPFlag,'DRR,','')}{!IF(MEBESJobviewTDTIMPWFlag,'MEBES Jobview TDTI-MPW,','')},
    <apex:repeat value="{!MasterData}" var="MRSLayer">
    {!counter},{!MRSLayer.OrigObj.Name}{!MRSLayer.OrigObj.Mask_Layer_Rev__c}{!if(MRSLayer.OrigObj.ROM_Code__c != '' && MRSLayer.OrigObj.ROM_Code__c != 'NULL' && MRSLayer.OrigObj.ROM_Code__c != '####',(BLANKVALUE('('+MRSLayer.OrigObj.ROM_Code__c+')','')),'')},{!MRSLayer.OrigObj.Layer_Status__c},{!IF(TechGeoDisplayFlag && MRSLayer.OrigObj.Tech_Geo__c != 'NULL',MRSLayer.OrigObj.Tech_Geo__c+',','')}{!IF(GDSOUTReviewCustomerFlag,MRSLayer.OrigObj.Customer_GDSOUT_Review__c+',','')}{!IF(GDSOUTReviewFoundryFlag,MRSLayer.OrigObj.Foundry_GDSOUT_Review__c+',','')}{!IF(FrameMockupCustomerFlag,MRSLayer.OrigObj.Customer_Frame_Mockup__c+',','')}{!IF(FrameMockupFoundryFlag,MRSLayer.OrigObj.Foundry_Frame_Mockup__c+',','')}{!IF(SendDataPrimeFlag,MRSLayer.OrigObj.Send_Prime_Data__c+',','')}{!IF(SendDataFrameFlag,MRSLayer.OrigObj.Send_Frame_Data__c+',','')}{!IF(ORCFlag,MRSLayer.OrigObj.ORC__c+',','')}{!IF(DRWFlag,MRSLayer.OrigObj.DRW__c+',','')}{!IF(CustomerRemoteJobviewPrimeFlag,MRSLayer.OrigObj.Customer_Prime_Remote_Jobview_Setup__c+',','')}{!IF(CustomerRemoteJobviewFrameFlag,MRSLayer.OrigObj.Customer_Frame_Remote_Jobview_Setup__c+',','')}{!IF(FoundryRemoteJobviewPrime,MRSLayer.OrigObj.Foundry_Prime_Remote_Jobview_Setup__c+',','')}{!IF(FoundryRemoteJobviewFrame,MRSLayer.OrigObj.Foundry_Frame_Remote_Jobview_Setup__c+',','')}{!IF(MEBESReceivedPrimeFlag,MRSLayer.OrigObj.Prime_MEBES_Received__c+',','')}{!IF(MEBESReceivedFrameFlag,MRSLayer.OrigObj.Frame_MEBES_Received__c+',','')}{!IF(MEBESJobviewCustomerFlag,MRSLayer.OrigObj.Customer_MEBES_Jobview__c+',','')}{!IF(MEBESJobviewFoundryFlag,MRSLayer.OrigObj.Foundry_MEBES_Jobview__c+',','')}{!IF(MEBESJobviewTapeoutCentreFlag,MRSLayer.OrigObj.Tapeout_Centre_MEBES_Jobview__c+',','')}{!IF(MEBESJobviewTapeoutApplicationsFlag,MRSLayer.OrigObj.Tapeout_Applications_MEBES_Jobview__c+',','')}{!IF(MEBESJobviewGlobalShuttleFlag,MRSLayer.OrigObj.GlobalShuttle_MEBES_Jobview__c+',','')}{!IF(MEBESJobviewMDPFlag,MRSLayer.OrigObj.MDP_MEBES_Jobview__c+',','')}{!IF(MEBESJobviewTDTIMPWFlag,MRSLayer.OrigObj.TDTI_MPW_MEBES_Jobview__c+',','')},
<apex:variable value="{!counter+1}" var="counter"/>
    </apex:repeat>
</apex:page>