<apex:page standardController="MRS__c" extensions="MRSCustomerGDSOUTReviewExtn"  showHeader="false" sideBar="false" standardStylesheets="false" 
contentType="application/vnd.ms-excel#GDSOUTReview.xls" cache="true">
    <apex:form >
        <table>
            <apex:outputLabel rendered="{!customerOrFoundry}">
                <tr align="center"><td colspan="5"><h2><u>GDSOUT Review - Customer</u></h2></td></tr>
            </apex:outputLabel>
            <apex:outputLabel rendered="{!!customerOrFoundry}">
                <tr align="center"><td colspan="5"><h2><u>GDSOUT Review - Foundry</u></h2></td></tr>
            </apex:outputLabel>
        </table>
        <br/>
        <table border="1">
            <apex:outputLabel rendered="{!isCustomerListActive}">
                <tr>
                    <th><b>Customer Name:</b></th>
                    <td >{!customerNameAfterSave}</td>
                </tr>
            </apex:outputLabel>
            <apex:outputLabel rendered="{!!isCustomerListActive}">
                <tr>
                    <th><b>Customer Name:</b></th>
                    <td >{!customerName}</td>
                </tr>
            </apex:outputLabel>
            <tr>
                <th><b>Mask Set Title:</b></th>
                <td >{!mstAfterSave}</td>
            </tr>
            
            
            <apex:outputLabel rendered="{!IF(selectedLayerStatus != '',true,false)}">
                <tr>
                    <th><b>Layer Status</b></th>
                    <td >{!selectedLayerStatus}</td>
                </tr>
            </apex:outputLabel>
            
            <apex:outputLabel rendered="{!IF(selectedLayerId != null,true,false)}">
                <tr>
                    <th><b>Mask Layer</b></th>
                    <td >{!selectedLayerId}</td>
                </tr>
            </apex:outputLabel>
            
            <apex:outputLabel rendered="{!IF(selectedChipId != null,true,false)}">
                <tr>
                    <th><b>Chip Name</b></th>
                    <td >{!selectedChipId}</td>
                </tr>
            </apex:outputLabel>
            
            <apex:outputLabel rendered="{!IF(selectedDeviceId != null,true,false)}">
                <tr>
                    <th><b>Device ID</b></th>
                    <td >{!selectedDeviceId}</td>
                </tr>
            </apex:outputLabel>
            
            <apex:outputLabel rendered="{!IF(selectedPTRFId != null,true,false)}">
                <tr>
                    <th><b>PTRF</b></th>
                    <td >{!selectedPTRFId}</td>
                </tr>
            </apex:outputLabel>
            
        </table>
        <br/>
        <table border="1">
            <thead>
                <tr align="center">
                    <th class="tcell_width_25">No.</th>
                    <th class="tcell_width_80">Mask Layer<br />(ROM Code)</th>
                    <th class="tcell_width_75">PTRF Number</th>
                       
                    <apex:outputLabel rendered="{!isTechGeoActive}">
                        <th class="tcell_width_70">Tech Geo</th>
                    </apex:outputLabel>
                   
                    <apex:repeat value="{!chipNameSet}" var="chip">
                        <th class="tcell_width_70">{!chip}</th>
                    </apex:repeat>
                           
                </tr>
                      
            </thead>
            <tbody>
                <apex:repeat value="{!otherdisplayTableList}" var="display">
                          
                    <tr align="center">
                        <td class="text-align-centre">{!display.slNo}</td>
                        <td>{!display.maskLayerROMCode}</td> 
                        <td>{!display.ptrf}</td>
                
                        <apex:outputLabel rendered="{!isTechGeoActive}">
                            <td>{!display.TechGeo}</td> 
                        </apex:outputLabel>
              
                        <apex:repeat value="{!chipNameSet}" var="chip">
                  
                            <apex:variable var="key" value="{!display.maskLayerROMCode+':'}{!chip}{!':'+display.ptrf}"/>
                            <apex:outputLabel rendered="{!customerOrFoundry}">
                                <td>{!uniqueStatusMapChanged[key]}</td>
                            </apex:outputLabel>
                            <apex:outputLabel rendered="{!!customerOrFoundry}">
                                <td>{!uniqueStatusMapChanged[key]}</td>
                            </apex:outputLabel>
                       </apex:repeat> 
              
                    </tr>
                 </apex:repeat>
            </tbody>
        </table>
    </apex:form> 
</apex:page>