<!--
    Author: Abhita Bansal
    Description: This serves as the List View page for MPW Approval Matrix.
    History: 
        ABansal    05232015    - page creation.
        Poulami    04072016    - Added new column PA Code (MPW-PP87).
-->
<apex:page id="MPWApprovalMatrixTabVF" showHeader="true" sidebar="true" controller="MPWApprovalMatrixTabController" cache="false">

	<apex:stylesheet value="{!URLFOR($Resource.MPWRelatedCSS, '/MPWRelatedCSS/MPWApprovalMatrixTab.css')}" />
    
    <apex:sectionHeader title="MPW" subtitle="MPW Approval Matrix" help="https://help.salesforce.com/htviewhelpdoc?id=co_edit.htm&siteLang=en_US" />
    <apex:pageMessages id="errorSection" />
    
    <apex:form id="form1">
        <apex:pageBlock id="mainBlock"> 
        
            <apex:pageBlockButtons location="top">
                <apex:commandButton value="Add New MPW Approval Matrix" action="{!addNew}" />
            </apex:pageBlockButtons>
            
            <apex:pageBlockTable id="mpwApprovalList" value="{!MPWApprovalMatrixRecords}" var="a" rendered="{!IF(OR(MPWApprovalMatrixRecords.size == null,MPWApprovalMatrixRecords.size > 0), true, false)}">
                <apex:column >
                    <apex:facet name="header">Action</apex:facet>
                    <apex:commandLink value="Edit" action="/apex/MPWApprovalMatrixTranxVF?id={!a.Id}&&tranx=Edit&&returnURL={!currentURL}"/>
                </apex:column>
                
                <apex:column value="{!a.Category__c}" headerClass="{!IF(sortField == 'Category__c', 'TableTitle', '')}">
                    <apex:facet name="header">
                        <apex:outputLabel styleClass="hand colDiv" onclick="sort('Category__c','{!IF(ISBLANK(sortType),'asc',IF(sortType == 'desc','asc','desc'))}');">
                            {!$ObjectType.MPW_Approval_Matrix__c.fields.Category__c.label}
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Category__c', sortType == 'ASC'), true, false)}" styleClass="sortASC"/>
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Category__c', sortType == 'DESC'), true, false)}" styleClass="sortDESC"/>
                        </apex:outputLabel>
                    </apex:facet>  
                </apex:column> 
                               
                <apex:column value="{!a.Fab__c}" headerClass="{!IF(sortField == 'Fab__c', 'TableTitle', '')}">
                    <apex:facet name="header">
                        <apex:outputLabel styleClass="hand colDiv" onclick="sort('Fab__c','{!IF(ISBLANK(sortType),'asc',IF(sortType == 'desc','asc','desc'))}');">
                            {!$ObjectType.MPW_Approval_Matrix__c.fields.Fab__c.label}
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Fab__c', sortType == 'ASC'), true, false)}" styleClass="sortASC"/>
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Fab__c', sortType == 'DESC'), true, false)}" styleClass="sortDESC"/>
                        </apex:outputLabel>
                    </apex:facet>     
                </apex:column>
                
                <apex:column value="{!a.Geometry__c}" headerClass="{!IF(sortField == 'Geometry__c', 'TableTitle', '')}">
                    <apex:facet name="header">
                        <apex:outputLabel styleClass="hand colDiv" onclick="sort('Geometry__c','{!IF(ISBLANK(sortType),'asc',IF(sortType == 'desc','asc','desc'))}');">
                            {!$ObjectType.MPW_Approval_Matrix__c.fields.Geometry__c.label}
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Geometry__c', sortType == 'ASC'), true, false)}" styleClass="sortASC"/>
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Geometry__c', sortType == 'DESC'), true, false)}" styleClass="sortDESC"/>
                        </apex:outputLabel>
                    </apex:facet>     
                </apex:column>
                
                <apex:column value="{!a.Sub_Category__c}" headerClass="{!IF(sortField == 'Sub_Category__c', 'TableTitle', '')}">
                    <apex:facet name="header">
                        <apex:outputLabel styleClass="hand colDiv" onclick="sort('Sub_Category__c','{!IF(ISBLANK(sortType),'asc',IF(sortType == 'desc','asc','desc'))}');">
                            {!$ObjectType.MPW_Approval_Matrix__c.fields.Sub_Category__c.label}
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Sub_Category__c', sortType == 'ASC'), true, false)}" styleClass="sortASC"/>
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Sub_Category__c', sortType == 'DESC'), true, false)}" styleClass="sortDESC"/>
                        </apex:outputLabel>
                    </apex:facet>     
                </apex:column>
                <!--04072016 - Added by Poulami Starts.-->
                <apex:column value="{!a.PA_Code__c}" headerClass="{!IF(sortField == 'PA_Code__c', 'TableTitle', '')}">
                    <apex:facet name="header">
                        <apex:outputLabel styleClass="hand colDiv" onclick="sort('PA_Code__c','{!IF(ISBLANK(sortType),'asc',IF(sortType == 'desc','asc','desc'))}');">
                            {!$ObjectType.MPW_Approval_Matrix__c.fields.PA_Code__c.label}
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'PA_Code__c', sortType == 'ASC'), true, false)}" styleClass="sortASC"/>
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'PA_Code__c', sortType == 'DESC'), true, false)}" styleClass="sortDESC"/>
                        </apex:outputLabel>
                    </apex:facet>     
                </apex:column>
                <!--04072016 - Added by Poulami Ends.-->
                <apex:column value="{!a.Step_1_Approver_1__c}" headerClass="{!IF(sortField == 'Step_1_Approver_1__c', 'TableTitle', '')}">
                    <apex:facet name="header">
                        <apex:outputLabel styleClass="hand colDiv" onclick="sort('Step_1_Approver_1__c','{!IF(ISBLANK(sortType),'asc',IF(sortType == 'desc','asc','desc'))}');">
                            {!$ObjectType.MPW_Approval_Matrix__c.fields.Step_1_Approver_1__c.label}
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Step_1_Approver_1__c', sortType == 'ASC'), true, false)}" styleClass="sortASC"/>
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Step_1_Approver_1__c', sortType == 'DESC'), true, false)}" styleClass="sortDESC"/>
                        </apex:outputLabel>
                    </apex:facet>     
                </apex:column>
                
                <apex:column value="{!a.Step_1_Approver_2__c}" headerClass="{!IF(sortField == 'Step_1_Approver_2__c', 'TableTitle', '')}">
                    <apex:facet name="header">
                        <apex:outputLabel styleClass="hand colDiv" onclick="sort('Step_1_Approver_2__c','{!IF(ISBLANK(sortType),'asc',IF(sortType == 'desc','asc','desc'))}');">
                            {!$ObjectType.MPW_Approval_Matrix__c.fields.Step_1_Approver_2__c.label}
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Step_1_Approver_2__c', sortType == 'ASC'), true, false)}" styleClass="sortASC"/>
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Step_1_Approver_2__c', sortType == 'DESC'), true, false)}" styleClass="sortDESC"/>
                        </apex:outputLabel>
                    </apex:facet>     
                </apex:column>
                
                <apex:column value="{!a.Step_1_Approver_3__c}" headerClass="{!IF(sortField == 'Step_1_Approver_3__c', 'TableTitle', '')}">
                    <apex:facet name="header">
                        <apex:outputLabel styleClass="hand colDiv" onclick="sort('Step_1_Approver_3__c','{!IF(ISBLANK(sortType),'asc',IF(sortType == 'desc','asc','desc'))}');">
                            {!$ObjectType.MPW_Approval_Matrix__c.fields.Step_1_Approver_3__c.label}
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Step_1_Approver_3__c', sortType == 'ASC'), true, false)}" styleClass="sortASC"/>
                            <apex:image value="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" rendered="{!IF(AND(sortField == 'Step_1_Approver_3__c', sortType == 'DESC'), true, false)}" styleClass="sortDESC"/>
                        </apex:outputLabel>
                    </apex:facet>     
                </apex:column>
                
                <apex:facet name="footer">Showing Page {!currentPageNo} of {!totalNoOfPages} ({!totalNoOfRecords} Records)</apex:facet>
            </apex:pageBlockTable>
            
            <apex:outputText value="No records retrieved." rendered="{!IF(MPWApprovalMatrixRecords.size == 0, true, false)}" />
            
            <!-- Pagination Controls -->
               
            <apex:outputPanel id="controlPanel" layout="block" rendered="{!IF(MPWApprovalMatrixRecords.size > 0, true, false)}">
                <center>
                        <apex:commandLink action="{!first}" style="text-decoration: none;" rendered="{!IF(HasPrevious, true, false)}" rerender="controlPanel, mpwApprovalList" status="loadStatus">
                            <apex:image value="/s.gif" styleClass="first1" alt="First Page" />
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!IF(NOT(HasPrevious), true, false)}">
                            <apex:image value="/s.gif" styleClass="firstoff1" alt="First Page" />
                        </apex:outputPanel>
                        &nbsp;
                        <apex:commandLink action="{!previous}" style="text-decoration: none;" rendered="{!IF(HasPrevious, true, false)}" rerender="controlPanel, mpwApprovalList" status="loadStatus">
                            <apex:image value="/s.gif" styleClass="prev1" alt="Previous" />Previous
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!IF(NOT(HasPrevious), true, false)}">
                            <apex:image value="/s.gif" styleClass="prevoff1" alt="Previous" />Previous
                        </apex:outputPanel>
                        &nbsp;&nbsp;
                        <apex:commandLink action="{!next}" style="text-decoration: none;" rendered="{!IF(HasNext, true, false)}" rerender="controlPanel, mpwApprovalList" status="loadStatus">
                            Next<apex:image value="/s.gif" styleClass="next1" alt="Next" />
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!IF(NOT(HasNext), true, false)}">
                            Next<apex:image value="/s.gif" styleClass="nextoff1" alt="Next" />
                        </apex:outputPanel>
                        &nbsp;
                        <apex:commandLink action="{!last}" style="text-decoration: none;" rendered="{!IF(HasNext, true, false)}" rerender="controlPanel, mpwApprovalList" status="loadStatus">
                            <apex:image value="/s.gif" styleClass="last1" alt="Last Page" />
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!IF(NOT(HasNext), true, false)}">
                            <apex:image value="/s.gif" styleClass="lastoff1" alt="Last Page" />
                        </apex:outputPanel>
                      </center>
            </apex:outputPanel>                         
        </apex:pageBlock>
        
        <apex:actionfunction name="sortRecords" action="{!sortRecords}" rerender="mpwApprovalList, errorSection" status="loadStatus">     
            <apex:param name="sortField" value="" />           
        </apex:actionfunction>
        
        <apex:actionStatus onstart="startLoading();" onstop="endLoading();" id="loadStatus"/>
        <div id="load_scrl" class="loadingBox loader" style="display: none" />
        <div class="loadingBox overlay" />
        
    </apex:form>
    
</apex:page>