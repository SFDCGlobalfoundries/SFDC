<apex:page standardController="DRT__c" extensions="DRTDetailExtn"  showHeader="false" sideBar="false" standardStylesheets="false" 
contentType="application/vnd.ms-excel#{!drtName}.xls" cache="true">

<apex:outputPanel id="frameDRTOutputId">
<apex:outputPanel id="frameDRTId" rendered="{!drtFrameType}">
<table>
    <tbody>
        <tr><td colspan="4"><h1><u>{!drtName}</u></h1></td></tr>
    </tbody>
</table>
        
<table border="1">
 <tr>
      <th>Customer Name:</th>
      <td >{!savedCustomerName}</td>
      <th>Status:</th>
      <td>{!savedStatus}</td>      
 </tr>
 <tr>
      <th>Mask Set Title:</th>
      <td>{!savedMaskSetTitle}</td>
      <th>DRT Type:</th>
      <td>{!savedDRTType}</td>      
 </tr>
 <apex:repeat var="l" value="{!lstDummy}" rendered="{!isTechGeoNull}">
     <tr>
          <th>Tech Geo:</th>
          <td>{!savedTechGeo}</td>
     </tr>
 </apex:repeat>
</table>

<br></br>
<br></br>

<table border="1">
    <tr><th>Description</th><td>{!description}</td></tr>
</table>

<br></br>
<br></br>

<table border="1">
                  <th>No.</th>
                  <th>Mask set Title</th>
                  <th>Mask Layer</th>
                  <th>Retrofit PTRF Mask Rev</th>
                  <th>Retrofit PTRF ROM Code</th>
                  <th>Mask Rev</th>
                  <th>ROM Code</th>
                  
</table> 

<table border="1">

         <apex:variable var="i" value="{!1}"/>
         <tbody>
             <apex:repeat value="{!frameDRTLst}"  var="frameDrt">
                 <tr> 
                   
                    <td align="center">{!i}</td>
                    <td align="center">{!frameDrt.Mask_Set_Title__r.Name}</td>
                    <td align="center">{!frameDrt.Mask_Layer_No__c}</td>
                    <td align="center">{!frameDrt.Retrofit_Mask_Rev__c}</td>
                    <td align="center">="{!frameDrt.Retrofit_ROM_Code__c}"</td>
                    <td align="center">{!frameDrt.Mask_Rev__c}</td>
                    <td align="center">="{!frameDrt.ROM_Code__c}"</td>
                 </tr>
                <apex:variable var="i" value="{!i+1}"/>
              </apex:repeat>
          </tbody>                
</table>
</apex:outputPanel> 
</apex:outputPanel>
                  
<apex:outputPanel id="primeDRTOutputId"> 
<apex:outputpanel id="primeDRTId" rendered="{!drtPrimeType}">
<table>
    <tbody>
        <tr><td colspan="4"><h1><u>{!drtName}</u></h1></td></tr>
    </tbody>
</table>
        
<table border="1">
 <tr>
      <th>Customer Name:</th>
      <td >{!savedCustomerName}</td>
      <th>Status:</th>
      <td>{!savedStatus}</td>      
 </tr>
 <tr>
      <th>Mask Set Title:</th>
      <td>{!savedMaskSetTitle}</td>
      <th>DRT Type:</th>
      <td>{!savedDRTType}</td>      
 </tr>
 <apex:repeat var="l" value="{!lstDummy}" rendered="{!isTechGeoNull}">
     <tr>
          <th>Tech Geo:</th>
          <td>{!savedTechGeo}</td>
     </tr>
 </apex:repeat>
</table>

<br></br>
<br></br>

<table border="1">
    <tr><th>Description</th><td>{!description}</td></tr>
</table>

<br></br>
<br></br>

<table border="1">
    <tbody>
         <tr>
           <th rowspan="3">No.</th>
           <th rowspan="3">Mask Set Title</th>
           <th rowspan="3">Prime Die/Scribeline Drop-in</th>
           
           
               <apex:repeat value="{!maskLayerHeaderWrapperList}" var="m"> 
                                <th rowspan="3">
                                    <table border="1">
                                        <tbody>
                                            <tr>
                                                <td colspan="2" align="center">
                                                    <strong>Mask Layer : {!m.layerNo}</strong>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td align="center">
                                                    {!m.retroftMaskRev}
                                                </td>
                                                <td align="center">
                                                    ="{!m.retroftRomCode}"
                                                </td>
                                            </tr>
                                            <tr>
                                                <th align="center">Mask Rev</th>
                                                <th align="center">ROM Code</th>
                                            </tr>
                                        </tbody>
                                    </table>
                               </th>
               </apex:repeat>         
        </tr>
    </tbody>
</table>

<table>
<tr><td>
<table border="1">
    <tbody>
         
            <apex:repeat value="{!chipWrapperList}" var="chip"> 
                <tr class="tcell_height_29">            
                    <td align="center">{!chip.counter}.</td> 
                    <td align="center">{!chip.mstName}</td> 
                    <td align="center">{!chip.chipName}</td>
                 </tr>                                                                        
          </apex:repeat>
    </tbody>
</table>
</td><td>            
 <table border="1">
    <tbody>            
          <apex:repeat value="{!chipWrapperList}" var="chip">
             <tr>
                <apex:repeat value="{!maskLayerHeaderWrapperList}" var="layer">
                    <apex:variable var="cell" value="{!mapDisplayedMaskLayerData[layer.layerID][chip.chipID]}"/>
                    <td align="center">{!cell['MaskRev']}</td> 
                    <td align="center">="{!cell['RomCode']}"</td>
               </apex:repeat>
             </tr>
          </apex:repeat>
     </tbody>
</table>
</td></tr>
</table>
</apex:outputpanel>
</apex:outputPanel>
</apex:page>