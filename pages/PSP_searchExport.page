<apex:page standardController="Device__c" extensions="PSP_searchExtension" tabStyle="Device__c" contentType="application/vnd.ms-excel#DevicePSPs.xls" sidebar="false" cache="true" readOnly="true">
<apex:stylesheet value="{!$Resource.Stylesheet_PSP_SearchPages}"/>
    
    <apex:pageBlock >
        <apex:facet name="header"><b><span style="font-size:24px;">Production Start Plan Details</span></b></apex:facet>
        <apex:outputPanel id="tablePanel">
            
            <table border="1" width="100%" style="border-collapse:collapse;border-color:#000000;">
                <apex:facet name="footer">Showing Page # {!pageNumber} of {!totalPages}</apex:facet>
                <caption style="background-color: #B9B9B9;"><b>Production Start Plan Details</b></caption>
                <thead>
                    <tr class="tg-center" style="background-color: #DCDCDC;">
                        <th rowspan="3" scope="col" class="tg-center">Device</th>
                        <th rowspan="3" scope="col" class="tg-center">Account</th>
                        <th rowspan="3" scope="col" class="tg-center">FAB</th>
                        <th rowspan="3" scope="col" class="tg-center">Opportunity</th>
                        <th rowspan="3" scope="col" class="tg-center">Geometry</th>
                        <apex:repeat value="{!lstYearsDisplay}" var="year">
                            <th colspan="12" class="tg-center" scope="col">{!year}</th>
                            <th colspan="1" rowspan="3" class="tg-center" scope="col">{!year}<br/>Total</th>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <apex:repeat value="{!lstYearsDisplay}" var="year">
                            <th colspan="3" style="background-color: #DCDCDC;" scope="col" class="tg-center">Q1</th>
                            <th colspan="3" style="background-color: #DCDCDC;" scope="col" class="tg-center">Q2</th>
                            <th colspan="3" style="background-color: #DCDCDC;" scope="col" class="tg-center">Q3</th>
                            <th colspan="3" style="background-color: #DCDCDC;" scope="col" class="tg-center">Q4</th>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <apex:repeat value="{!lstYearsDisplay}" var="year">
                            <th colspan="1" scope="col">Jan</th>
                            <th colspan="1" scope="col">Feb</th>
                            <th colspan="1" scope="col">Mar</th>
                            <th colspan="1" scope="col">Apr</th>
                            <th colspan="1" scope="col">May</th>
                            <th colspan="1" scope="col">Jun</th>
                            <th colspan="1" scope="col">Jul</th>
                            <th colspan="1" scope="col">Aug</th>
                            <th colspan="1" scope="col">Sep</th>
                            <th colspan="1" scope="col">Oct</th>
                            <th colspan="1" scope="col">Nov</th>
                            <th colspan="1" scope="col">Dec</th>
                        </apex:repeat>
                    </tr>
                </thead>
                <tbody>
                    <apex:repeat value="{!SearchResult}" var="device" id="theTable">
                        <tr>
                            <td rowspan="2"><apex:outputLink value="/{!device.Id}" id="theLink"><apex:outputText value="{!IF((Len(device.name)<11),device.name, LEFT(device.name,10) + '<br>'+IF((Len(device.name) < 21), RIGHT(device.name,LEN(device.name)-10),RIGHT(LEFT(device.name,20),10)+'<BR>'+RIGHT(device.name, LEN(device.name)-20)))}" escape="false"></apex:outputText></apex:outputLink></td>
                            <td rowspan="2"><apex:outputText value="{!IF((Len(device.Account__r.name)<11),device.Account__r.name, LEFT(device.Account__r.name,10) + '<br>'+IF((Len(device.Account__r.name) < 21), RIGHT(device.Account__r.name,LEN(device.Account__r.name)-10),RIGHT(LEFT(device.Account__r.name,20),10)+'<BR>'+RIGHT(device.Account__r.name, LEN(device.Account__r.name)-20)))}" escape="false"></apex:outputText></td>
                            <td rowspan="2">{!device.Fab__c}</td>
                            <td rowspan="2"><apex:outputText value="{!IF((Len(device.Opportunity2__r.name)<11),device.Opportunity2__r.name, LEFT(device.Opportunity2__r.name,10) + '<br>'+IF((Len(device.Opportunity2__r.name) < 21), RIGHT(device.Opportunity2__r.name,LEN(device.Opportunity2__r.name)-10),RIGHT(LEFT(device.Opportunity2__r.name,20),10)+'<BR>'+RIGHT(device.Opportunity2__r.name, LEN(device.Opportunity2__r.name)-20)))}" escape="false"></apex:outputText></td>
                            <td rowspan="2">{!device.Geometry__c}</td>
                            <apex:repeat value="{!device.DevicePSPs_Data__r}" var="devicePSP">
                                <td><apex:outputText value="{!devicePSP.Month_1__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_2__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_3__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_4__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_5__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_6__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_7__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_8__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_9__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_10__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_11__c}"/></td>
                                <td><apex:outputText value="{!devicePSP.Month_12__c}"/></td>
                                <td style="background-color:#B9B9B9;font-weight:bold;" colspan="1" rowspan="2"><apex:outputText value="{!devicePSP.Month_1__c+devicePSP.Month_2__c+devicePSP.Month_3__c+devicePSP.Month_4__c+devicePSP.Month_5__c+devicePSP.Month_6__c+devicePSP.Month_7__c+devicePSP.Month_8__c+devicePSP.Month_9__c+devicePSP.Month_10__c+devicePSP.Month_11__c+devicePSP.Month_12__c}"/></td>
                            </apex:repeat>
                        </tr>
                        <tr>
                            <apex:repeat value="{!device.DevicePSPs_Data__r}" var="devicePSP">
                                <td colspan="3" class="tg-center"><apex:outputText value="{!devicePSP.WaferStart_Quarter1__c}"/></td>
                                <td colspan="3" class="tg-center"><apex:outputText value="{!devicePSP.WaferStart_Quarter2__c}"/></td>
                                <td colspan="3" class="tg-center"><apex:outputText value="{!devicePSP.WaferStart_Quarter3__c}"/></td>
                                <td colspan="3" class="tg-center"><apex:outputText value="{!devicePSP.WaferStart_Quarter4__c}"/></td>
                            </apex:repeat>
                        </tr>
                    </apex:repeat>
                    
                    <tr style="background-color:#ffdd99;">
                        <td style="text-align: center;" colspan="3" rowspan="2"><b>Prototype Wafer Outs</b></td>
                        <td colspan="2" rowspan="1"><b>Monthly TTL</b></td>
                        <apex:repeat value="{!lstprototypeWaferOutsTTL}" var="waferForecastRec">
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month1}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month2}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month3}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month4}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month5}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month6}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month7}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month8}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month9}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month10}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month11}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month12}"/></td>
                            <td style="background-color:#FFFF00;font-weight:bold;" colspan="1" rowspan="2"><apex:outputText value="{!waferForecastRec.month1+waferForecastRec.month2+waferForecastRec.month3+waferForecastRec.month4+waferForecastRec.month5+waferForecastRec.month6+waferForecastRec.month7+waferForecastRec.month8+waferForecastRec.month9+waferForecastRec.month10+waferForecastRec.month11+waferForecastRec.month12}"/></td>
                        </apex:repeat>
                    </tr>
                    <tr style="background-color:#ffdd99;">
                        <td colspan="2" rowspan="1"><b>Qtrly TTL</b></td>
                        <apex:repeat value="{!lstprototypeWaferOutsTTL}" var="waferForecastQuarterRec">
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter1}"/></td>
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter2}"/></td>    
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter3}"/></td>    
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter4}"/></td>    
                        </apex:repeat>
                    </tr>
                    
                    <tr style="background-color:#dad971;">
                        <td style="text-align: center;" colspan="3" rowspan="2"><b>Production Wafer Outs</b></td>
                        <td colspan="2" rowspan="1"><b>Monthly TTL</b></td>
                        <apex:repeat value="{!lstproductionWaferOutsTTL}" var="waferForecastRec">
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month1}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month2}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month3}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month4}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month5}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month6}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month7}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month8}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month9}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month10}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month11}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month12}"/></td>
                            <td style="background-color:#FFFF00;font-weight:bold;" colspan="1" rowspan="2"><apex:outputText value="{!waferForecastRec.month1+waferForecastRec.month2+waferForecastRec.month3+waferForecastRec.month4+waferForecastRec.month5+waferForecastRec.month6+waferForecastRec.month7+waferForecastRec.month8+waferForecastRec.month9+waferForecastRec.month10+waferForecastRec.month11+waferForecastRec.month12}"/></td>
                        </apex:repeat>
                    </tr>
                    <tr style="background-color:#dad971;">
                        <td colspan="2" rowspan="1"><b>Qtrly TTL</b></td>
                        <apex:repeat value="{!lstproductionWaferOutsTTL}" var="waferForecastQuarterRec">
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter1}"/></td>
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter2}"/></td>    
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter3}"/></td>    
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter4}"/></td>    
                        </apex:repeat>
                    </tr>
                    
                    <tr style="background-color:#b3daff;">
                        <td style="text-align: center;" colspan="3" rowspan="2"><b>Opportunity Forecast</b></td>
                        <td colspan="2" rowspan="1"><b>Monthly TTL</b></td>
                        <apex:repeat value="{!lstOppWaferOuts}" var="waferForecastRec">
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month1}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month2}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month3}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month4}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month5}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month6}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month7}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month8}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month9}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month10}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month11}"/></td>
                            <td class="tg-center"><apex:outputText value="{!waferForecastRec.month12}"/></td>
                            <td style="background-color:#FFFF00;font-weight:bold;" colspan="1" rowspan="2"><apex:outputText value="{!waferForecastRec.month1+waferForecastRec.month2+waferForecastRec.month3+waferForecastRec.month4+waferForecastRec.month5+waferForecastRec.month6+waferForecastRec.month7+waferForecastRec.month8+waferForecastRec.month9+waferForecastRec.month10+waferForecastRec.month11+waferForecastRec.month12}"/></td>
                        </apex:repeat>
                    </tr>
                    <tr style="background-color:#b3daff;">
                        <td colspan="2" rowspan="1"><b>Qtrly TTL</b></td>
                        <apex:repeat value="{!lstOppWaferOuts}" var="waferForecastQuarterRec">
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter1}"/></td>
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter2}"/></td>    
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter3}"/></td>    
                            <td colspan="3" class="tg-center"><apex:outputText value="{!waferForecastQuarterRec.quarter4}"/></td>    
                        </apex:repeat>
                    </tr>
              
                </tbody>
                
            </table>
            
            Showing Page # {!pageNumber} of {!totalPages}
            <br/><br/>
                        
        </apex:outputPanel>
    </apex:pageBlock>
</apex:page>