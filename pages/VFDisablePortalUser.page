<!-- 
Type Name: VFDisablePortalUser.page
Author: Cognizant 
Created Date: 03-May-2013
Reason: This Page is used for deactivating the portal contact and its corresponding Portal user- whenever a Contact is disabled as a portal User
Change History:
Author: 
Modified Date: 
Reason: 
 -->
<apex:page standardController="Contact" extensions="clsDisablePortalUserController" showHeader="false" sidebar="false" action="{!deactivateContact}">
    <head>
        <apex:includeScript value="{!URLFOR($Resource.jQuery_FoundryView2, '/jquery-1.8.2.min.js')}"/>
        <apex:includeScript value="{!URLFOR($Resource.jQuery_FoundryView2, '/postmessage/jquery.ba-postmessage.js')}"/>
        <apex:includeScript value="{!$Resource.jqueryblockUI}"/>
    
        <script type="text/javascript">
            var j$ = jQuery.noConflict();
    
            var parent_domain = '{!$CurrentPage.parameters.parent_domain}';
    
            j$(document).ready(function() {
                j$('input[id$=btnCloseModalDialog]').click(function(event) {
                    event.preventDefault();
                    closeModalDialog();
                });
            });
            
            
            function closeModalDialog() {
                var redirectUrl = j$('input[id$=redirectUrl]').val();
                //var cross_result = new Object();
                //cross_result.action = 'close_modal_dialog_refresh';
                //cross_result.redirect_url = redirectUrl;
                //j$.postMessage(
                  //  cross_result,
                    //parent_domain,
                    //parent
                //);
               //blockme();
               
               //parent.window.location=redirectUrl;
               parent.location.href = redirectUrl; // Updated as href
               self.close();
            }
              function blockme() {
           j$.blockUI({message: '<img src="{!URLFOR($Resource.Loader)}">'});    
         }  
            
      </script>
    </head>
    <apex:form >
       <apex:pageBlock >
       
           <apex:pageMessage summary="{!sMsg}" severity="{!sSeverity}" strength="3" id="pmMessage"/>
            <apex:pageBlockButtons location="bottom" id="pgbtn">
                <apex:commandButton id="btnCloseModalDialog" value="Close"/>                
            </apex:pageBlockButtons>
            <apex:inputHidden id="redirectUrl" value="{!redirectUrl}" />
            <apex:inputHidden value="{!Contact.AccountId}" id="contactAccount" />
         </apex:pageBlock>
      </apex:form>
</apex:page>