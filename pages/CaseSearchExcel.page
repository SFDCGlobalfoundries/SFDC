<!-- 
    Type Name: CaseSearchExcel.page
    Author: Cognizant Case Mgmt Team
    Created Date: 20-Nov-2014
    Reason: 
    Change History:
    Author: 
    Modified Date: 
    Reason: 
    -->
<apex:page readOnly="true" showHeader="false" sidebar="false" cache="false"  
    controller="CaseSearchController" showChat="false" contentType="application/vnd.ms-excel#CaseSearchResult-{!fileName}.xls" >
    <style>
        table {
        width:100%;
        }
        table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
        }
        th, td {
        padding: 5px;
        text-align: left;
        }
        table#t01 tr:nth-child(even) {
        background-color: #eee;
        }
        table#t01 tr:nth-child(odd) {
        background-color:#fff;
        }
        table#t01 th    {
        background-color: black;
        color: white;
        }
    </style>
    <apex:outputPanel rendered="{!ISNULL($CurrentPage.parameters.param)}" >
    <table rendered="{!ISNULL($CurrentPage.parameters.param)}">
        <tr>
            <td><b>Total No of Cases: {!totalRecords}</b></td>
        </tr>
    </table>
    <table id="t01" border="1" style="width:100%" rendered="{!ISNULL($CurrentPage.parameters.param)}">
        <tr>
            <th>{!$ObjectType.Case.Fields.CaseNumber.Label}</th>
            <th>{!$ObjectType.Case.Fields.Subject.Label}</th>
            <th>{!$ObjectType.Case.Fields.Account_Name__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Category__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Subcategory__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Priority.Label}</th>
            <th>{!$ObjectType.Case.Fields.Status.Label}</th>
            <th>Owner</th>
            <th>{!$ObjectType.Case.Fields.Project__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Geometry__c .Label}</th>
            <th>Contact</th>
            <th>{!$ObjectType.Case.Fields.PDK_Name__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Case_Record_Type__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Need_by_Date__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.CreatedDate.Label}</th>
            <th>CreatedBy</th>
            <th>{!$ObjectType.Case.Fields.LastModifiedDate.Label}</th>
        </tr>
        <apex:repeat value="{!listCasePage}" var="a">
            <tr>
                <td>{!a.CaseNumber}</td>
                <td>{!a.Subject}</td>
                <td>{!a.Account_Name}</td>
                <td>{!a.Category}</td>
                <td>{!a.Subcategory}</td>
                <td>{!a.Priority}</td>
                <td>{!a.Status}</td>
                <td>{!a.OwnerName}</td>
                <td>{!a.Project}</td>
                <td>{!a.Geometry}</td>
                <td>{!a.ContactName}</td>
                <td>{!a.PDK_Name}</td>
                <td>{!a.Case_Record_Type}</td>
                <td>{!a.Need_by_Date}</td>
                <td>{!a.CreatedDate}</td>
                <td>{!a.CreatedByName}</td>
                <td>{!a.LastModifiedDate}</td>
            </tr>
        </apex:repeat>
    </table>
    </apex:outputPanel>
    <apex:outputPanel rendered="{!NOT(ISNULL($CurrentPage.parameters.param))}">
    <table rendered="{!NOT(ISNULL($CurrentPage.parameters.param))}">
        <tr>
            <td><b>Total No of Cases: {!totalRecordsAdv}</b></td>
        </tr>
    </table>
    <table id="t02" border="1" style="width:100%" rendered="{!NOT(ISNULL($CurrentPage.parameters.param))}">
        <tr>
            <th>{!$ObjectType.Case.Fields.CaseNumber.Label}</th>
            <th>{!$ObjectType.Case.Fields.Subject.Label}</th>
            <th>{!$ObjectType.Case.Fields.Account_Name__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Category__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Subcategory__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Priority.Label}</th>
            <th>{!$ObjectType.Case.Fields.Status.Label}</th>
            <th>Owner</th>
            <th>{!$ObjectType.Case.Fields.Project__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Geometry__c .Label}</th>
            <th>Contact</th>
            <th>{!$ObjectType.Case.Fields.PDK_Name__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Case_Record_Type__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.Need_by_Date__c.Label}</th>
            <th>{!$ObjectType.Case.Fields.CreatedDate.Label}</th>
            <th>CreatedBy</th>
            <th>{!$ObjectType.Case.Fields.LastModifiedDate.Label}</th>
        </tr>
        <apex:repeat value="{!listCasePageAdv}" var="a">
            <tr>
                <td>{!a.CaseNumber}</td>
                <td>{!a.Subject}</td>
                <td>{!a.Account_Name}</td>
                <td>{!a.Category}</td>
                <td>{!a.Subcategory}</td>
                <td>{!a.Priority}</td>
                <td>{!a.Status}</td>
                <td>{!a.OwnerName}</td>
                <td>{!a.Project}</td>
                <td>{!a.Geometry}</td>
                <td>{!a.ContactName}</td>
                <td>{!a.PDK_Name}</td>
                <td>{!a.Case_Record_Type}</td>
                <td>{!a.Need_by_Date}</td>
                <td>{!a.CreatedDate}</td>
                <td>{!a.CreatedByName}</td>
                <td>{!a.LastModifiedDate}</td>
            </tr>
        </apex:repeat>
    </table>
    </apex:outputPanel>
</apex:page>