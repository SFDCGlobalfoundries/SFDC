<!--
    Author: Anirban Roy
    Description: This serves as the error page for FMS Configuration.
    History: 
        ARoy    23042017    - page creation. 
-->
<apex:page id="pgId" Controller="FMSValidation" action="{!checkMandatory}" showHeader="false" sidebar="false" >
    <apex:pageMessages id="pageErrorId" />
    
    <apex:form id="formId">
        <!--<apex:actionFunction action="{!checkMandatory}" name="checkReq" reRender="pageErrorId,refreshPanelId,msgId,pgBlock"/>-->
        <apex:outputPanel id="inProgressId" styleClass="progress" style="font-weight: bold;display:none">Processing the request...</apex:outputPanel>
        <apex:outputPanel id="refreshPanelId">
            <script>
                function refreshParentPage(){
                    if({!!isError}){                        
                        document.getElementsByClassName('progress')[0].style.display = "block";
                        //document.getElementById('pgId:formId:pgBlock:msgId').style.display = "none";
                         document.getElementById('pgId:pageErrorId').style.display = "none";
                        document.getElementById('pgId:formId:pgBlock:pgBlockBtn:confirmId').style.display = "none";
                        if(document.referrer.indexOf("GlobalfoundryView")>0){
                            top.window.location.href = '/GlobalfoundryView/apex/ProposalSummary?{!params}';
                        }else{                       
                            top.window.location.href = '/apex/ProposalSummary?{!params}';
                        } 
                    }else{
                        document.getElementsByClassName('progress')[0].style.display = "none";
                    }   
                }
                //refreshParentPage();
            </script>
            
        </apex:outputPanel>
        <apex:pageBlock mode="maindetail" id="pgBlock">
        <!--<apex:outputPanel id="msgId" styleClass="msg" rendered="{!!isError}">Once you click "Confirm" you will not be able to make any changes until and unless you come back to configuration from FMS form.</apex:outputPanel>-->
        <apex:pageBlockButtons id="pgBlockBtn" location="bottom">
            <apex:commandLink id="confirmId" onclick="refreshParentPage();return false;" value="Confirm" rendered="{!!isError}" styleClass="btn" style="text-decoration:none;"/>              
        </apex:pageBlockButtons>
    </apex:pageBlock>
    </apex:form>
    <script>
        /*window.onload=function()
        {
            checkReq();

        };*/
            
    </script>
</apex:page>