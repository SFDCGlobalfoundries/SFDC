<!-- 
    Type Name: StandardListViewExport
    Author: Cognizant Case Management Team
    Created Date:20-Jan-2015
    Reason: Visualforce page to export the records directly from list view.
    Change History:
    Author: 
    Modified Date: 
    Reason: 
    -->
<apex:page controller="StandardListViewExportAPI" cache="false" readOnly="true" action="{!fetchListviewRecords}" 
 showchat="false" showheader="false" sidebar="false" language=" fr_CA" contentType="application/vnd.ms-excel#{!fileName}.xls" >
    <style>
        table {
            width:100%;
        }
        table, th, td {
            border-collapse: collapse;
        }
        th, td {
            padding: 5px;
            text-align: left;
        }
    </style>
    <table border="1">
        <tr>
            <apex:repeat value="{!columnName}" var="colName">
                <th>{!colName}</th>
            </apex:repeat>
        </tr>
        <apex:repeat value="{!allRecords}" var="records">
            <apex:repeat value="{!records}" var="rec">
                <tr>
                    <apex:repeat value="{!fields}" var="fieldName">
                        <td><apex:outputText value=" {!rec[fieldName]}"/></td>
                    </apex:repeat>
                </tr>
            </apex:repeat>
        </apex:repeat>
    </table>
</apex:page>