<!-- 
    Author: Anirban Roy
    Description: This serves as the visualforce page for the Account Team Proxy user addition to PPE Team.
    History: 
        ARoy    03182013    - page creation.        
-->

<apex:page controller="PPETeamATPController" Tabstyle="PPE_Team__c">    
    <apex:pageMessages id="errorSection" />
    <apex:form >    
        <apex:pageBlock Title="Add Account Team Proxy to PPE Team" id="atpPPETeam">
            <apex:pageBlockSection Title="List of Account Team Proxy" rendered="{!atpWrapperList.size>0}">              
                <apex:dataTable value="{!atpWrapperList}" var="a" cellpadding="4" border="1">
                    <apex:column >
                        <apex:facet name="header"> 
                            <apex:inputCheckbox onclick="checkAll(this)" />
                        </apex:facet>
                        <apex:inputCheckbox value="{!a.selected}" id="checkedone" />
                    </apex:column>
                    <apex:column headervalue="Name" value="{!a.atp.User__r.Name}" />
                    <apex:column headervalue="System Profile" value="{!a.atp.User__r.Profile.Name}" />
                    <apex:column headervalue="Account Team Proxy Role" value="{!a.atp.Team_Role__c}" />
                    <apex:column >
                            <apex:facet name="header">PPE Team Role</apex:facet>
                            <apex:selectList value="{!a.ppeRoleSelected}" multiselect="false" size="1" >
                                <apex:actionSupport event="onchange" action="{!changeAccessLevel}" rerender="atpPPETeam"/>
                                <apex:selectOptions value="{!a.ppeRoleOption}"/>
                            </apex:selectList>
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">PPE Team Access Level</apex:facet>
                        <apex:selectList value="{!a.accessLevelSelected}" multiselect="false" size="1" >
                            <apex:selectOptions value="{!a.accessLevelOption}"/>
                        </apex:selectList>
                    </apex:column>
                </apex:dataTable>
            </apex:pageBlockSection>    
            <apex:pageBlockButtons >                 
                <apex:commandButton value="Save" action="{!save}" rendered="{!showSaveButton}"/>
                <apex:commandButton value="Cancel" action="{!cancel}" />                                  
            </apex:pageBlockButtons>
        </apex:pageBlock>
    </apex:form>
    <script>
        function checkAll(cb)
        {
            var inputElem = document.getElementsByTagName("input");
            for(var i=0; i<inputElem.length; i++)
            {
                if(inputElem[i].id.indexOf("checkedone")!=-1){
                    inputElem[i].checked = cb.checked;
                }
            }
        }    
    </script>
</apex:page>