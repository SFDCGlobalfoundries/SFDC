<!--
    Author: Nikhil Jain
    Description: This serves as the visualforce page for the 'Mass Edit' of 'Tracked Lot' records associated to particular 'Lot Tracker' record.
    History: 
        NJain    20/12/2013    - page creation.
        NJain    24/01/2014    - Changed the field referenced for Planned F/O Date from Project_Fabout_Date__c to Planned_Fabout_Date__c
        NJain    07/02/2014    - Replaced 'Customer Device Id' with 'Device Id(MES)'
-->
<apex:page standardController="Lot_Tracker__c" readOnly="true" sidebar="false" extensions="LotTrackerExportExtension" contentType="application/vnd.ms-excel#TrackedLots.xls" cache="true">
    <script>
    window.onload(){
        alert('Hello');
    }
    </script>
    
    <apex:pageBlock >
        <apex:outputText style="color:red;" value="No Tracked Lot records found." rendered="{!noRecordsSelected}" /> 
        <apex:pageBlockTable value="{!lstTrackedLots}" var="a" border="2px;">
            <apex:column >                               
                <apex:facet name="header">Fab</apex:facet>
                <apex:outputText value="{!a.Manufacturing_Lot__r.Fab_Group__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Type</apex:facet>
                <apex:outputText value="{!a.Type__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Tech</apex:facet>
                <apex:outputText value="{!a.Geometry__c}"/>
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">PO#</apex:facet>
                <apex:outputText value="{!a.Manufacturing_Lot__r.Purchase_Order_Number__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">GDPW </apex:facet>
                <apex:outputText value="{!a.GDPW__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Device</apex:facet>
                <apex:outputText value="{!a.Manufacturing_Lot__r.Device_ID_MES__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Lot ID</apex:facet>
                <apex:outputText value="{!a.Manufacturing_Lot__r.name}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Qty</apex:facet>
                <apex:outputText value="{!a.QTY_Description__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">WIP QTY</apex:facet>
                <apex:outputText value="{!a.Manufacturing_Lot__r.Current_Wafer_Quantity_In_Lot__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">T/o Date</apex:facet>
                <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                    <apex:param value="{!a.Tapeout_Date__c}" /> 
                </apex:outputText>
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Proj Reticle ETA</apex:facet>
                <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                    <apex:param value="{!a.Reticle_ETA__c}" /> 
                </apex:outputText>
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Planned F/o Date</apex:facet>
                <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                    <apex:param value="{!a.Manufacturing_Lot__r.Planned_Fabout_Date__c}"/> 
                </apex:outputText>
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">CSD</apex:facet>
                <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                    <apex:param value="{!a.Current_CSD_ML__c}"/> 
                </apex:outputText>
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Current Stage</apex:facet>
                <apex:outputText value="{!a.Current_Stage_ML__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Bal ML</apex:facet>
                <apex:outputText value="{!a.Remaining_Mask_Count__c}"/>                                                                              
            </apex:column>
            <apex:column >                               
                <apex:facet name="header">Total Mask</apex:facet>
                <apex:outputText value="{!a.Manufacturing_Lot__r.Total_Mask_Count__c}"/>                                                                              
            </apex:column>                
            <apex:column >                               
                <apex:facet name="header">Remarks</apex:facet>
                <apex:outputText value="{!a.Remarks__c}"/>                                                                              
            </apex:column>
            
        </apex:pageBlockTable>  
    </apex:pageBlock>
</apex:page>