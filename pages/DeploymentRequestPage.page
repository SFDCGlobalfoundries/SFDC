<apex:page standardController="Deployment_Request__c" extensions="DeploymentRequestController" tabStyle="Deployment_Request__c">
  
<apex:includeScript value="{!$Resource.JSBclUI}"/>
 

    
    <script type="text/javascript">
    $j = jQuery.noConflict(); 
    
    function blockPage(){ 
    alert('hi');
        $j.blockUI({ message: '<img src="/img/loading32.gif" /><h1> Refreshing...</h1>', 
            css: { 
             border: 'none', 
             padding: '15px',  
             '-webkit-border-radius': '10px', 
             '-moz-border-radius': '10px', 
             opacity: .9
            } 
        }); 
        return false;
    }

function unblockPage(){
        $j.unblockUI();
    }
    


</script>
    
    <apex:form id="drform">
        <apex:actionFunction name="fetchChangeTypeValuesfn" action="{!fetchChangeTypeValues}" reRender="changeTypeList" oncomplete="" status="status"/>
        
        <apex:actionFunction name="fetchApplicationNameValuesfn" action="{!fetchApplicationNameValues}" reRender="applicationNameList" oncomplete="" status="status"/>
       
        <apex:actionFunction name="updateStagesfn" action="{!updateStages}" reRender="drstage,reviewInfoPanel" oncomplete="" />
          <apex:actionStatus id="status">
                        <apex:facet name="start">
                        <apex:outputPanel >
                            
                            <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.75; z-index: 1000; background-color: black;">
                            &nbsp;
                            </div>
                            <div style="position: fixed; left: 0; top: 0; bottom: 0; right: 0; z-index: 1001; margin: 30% 50%">
                            <img src="/img/loading32.gif" width="25" height="25" />
                            <apex:outputLabel value="Loading..."/>
                            </div>
                        </apex:outputPanel>            
                        </apex:facet>
                    </apex:actionStatus>       
        <apex:pageBlock id="drblock">
        <apex:pageMessages ></apex:pageMessages>
            <apex:pageBlockSection title="DR Message">
            <apex:outputPanel style="font-size:15px;color:blue;" rendered="true">
            <b>
            <h1 >
            Welcome to New DR Process. For more details Please <a style="font-size:15px;color:blue;" href="{!urlDR}" target="_blank">click here</a>
            </h1>
            </b>
            </apex:outputPanel>
            </apex:pageBlockSection>   
 
                <apex:pageBlockButtons >
                <apex:commandButton value="Save" action="{!save}" reRender="drblock" onComplete=""/>
                <apex:commandButton value="Cancel" action="{!cancel}"/>
            </apex:pageBlockButtons>
            <apex:pageBlockSection title="Deployment Request Detail">
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Request Type"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:selectList value="{!drObject.Request_Type_txt__c}" multiselect="false" size="1" onchange="fetchChangeTypeValuesfn()">
                        <apex:selectOptions value="{!requestType}"/>
                    </apex:selectList>     
                    </apex:outputPanel>           
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!drObject.OwnerId}"/>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Change Type"></apex:outputText>
                    <apex:selectList value="{!drObject.Change_Type_txt__c}" multiselect="false" size="1" disabled="{!disableChangeType}" id="changeTypeList">
                        <apex:selectOptions value="{!changeType}"/>
                    </apex:selectList>                                    
                </apex:pageBlockSectionItem>
                <apex:inputField value="{!drObject.CR_Number__c}"/>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Source Environment"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>                    
                    <apex:selectList value="{!drObject.Source_Environment_txt__c}" multiselect="false" size="1">
                        <apex:selectOptions value="{!sourceEnvironment}"/>
                    </apex:selectList> 
                    </apex:outputPanel>               
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Target Environment"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:selectList value="{!drObject.Target_Environment_txt__c}" multiselect="false" size="1" onchange="updateStagesfn()">
                        <apex:selectOptions value="{!targetEnvironment}"/>
                    </apex:selectList>       
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>                                
                <!--<apex:pageBlockSectionItem >
                    <apex:outputText value="Deployment Status"></apex:outputText>
                    <apex:selectList value="{!drObject.Deployment_Status_txt__c}" multiselect="false" size="1">
                        <apex:selectOptions value="{!deploymentStatus}"/>
                    </apex:selectList>                
                </apex:pageBlockSectionItem>                             
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Review Status"></apex:outputText>
                    <apex:selectList value="{!drObject.RM_Review_Status_txt__c}" multiselect="false" size="1">
                        <apex:selectOptions value="{!reviewStatus}"/>
                    </apex:selectList>                
                </apex:pageBlockSectionItem> -->                            
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Application Category"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>                                        
                    <apex:selectList value="{!drObject.Application_Category_txt__c}" multiselect="false" size="1" onchange="fetchApplicationNameValuesfn()">
                        <apex:selectOptions value="{!applicationCategory}"/>
                    </apex:selectList>    
                    </apex:outputPanel>            
                </apex:pageBlockSectionItem>  
                <apex:pageBlockSectionItem >  
                <apex:outputText value="Requested Deployment Date/Time"></apex:outputText>
                <apex:outputPanel layout="block" styleClass="requiredInput">
                <apex:outputPanel layout="block" styleClass="requiredBlock"/> 
                <apex:inputField value="{!drObject.Deployment_Request_Date_Time__c}"/>  
                </apex:outputPanel>      
                </apex:pageBlockSectionItem>                            
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Application Name"></apex:outputText>
                    <apex:selectList value="{!drObject.Application_Name_txt__c}" multiselect="false" size="1" disabled="{!disableApplicationName}" id="applicationNameList">
                        <apex:selectOptions value="{!applicationName}"/>
                    </apex:selectList>                
                </apex:pageBlockSectionItem>      
                <apex:inputField value="{!drObject.Clarity_Project_Id__c}"/>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Short Description"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>   
                    <apex:inputText value="{!drObject.Short_Description__c}" style="width:315px;"/>
                    </apex:outputPanel> 
                </apex:pageBlockSectionItem>
                <apex:inputField value="{!drObject.UAT_DR__c}"/>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Description"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>   
                    <apex:inputTextarea value="{!drObject.Description__c}" style="width:315px;height:100px;"/>
                    </apex:outputPanel> 
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="System Affected"></apex:outputText>
                    <apex:selectList value="{!drObject.System_Affected_txt__c}" multiselect="false" size="1" style="width:200px;">
                        <apex:selectOptions value="{!systemAffected}"/>
                    </apex:selectList>                
                </apex:pageBlockSectionItem>      
                <!-- <apex:pageBlockSectionItem >
                    <apex:outputText value="Stage"></apex:outputText>
                  
                    <apex:selectList value="{!drObject.Stage_txt__c}" multiselect="false" size="1" id="drstage">
                        <apex:selectOptions value="{!stages}"/>
                    </apex:selectList>
                   
                </apex:pageBlockSectionItem>     -->  
              <!--  <apex:inputField value="{!drObject.Compliance_Review_Required__c}"/>  -->                    
            </apex:pageBlockSection>
            <apex:pageBlockSection title="Review Information" id="reviewInfoPanel">              
               <apex:pageBlockSectionItem rendered="{!IF(drObject.Target_Environment_txt__c == 'Production', false, true)}">
                    <apex:outputText value="Is TFA Review Completed"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:selectList value="{!drObject.Is_TFA_Review_Completed_txt__c}" multiselect="false" size="1">
                        <apex:selectOptions value="{!tfaReviewCompleted}"/>
                    </apex:selectList>
                    </apex:outputPanel>                
                </apex:pageBlockSectionItem> 
                
                <apex:pageBlockSectionItem rendered="{!IF(drObject.Target_Environment_txt__c == 'Production', false, true)}">
                    <apex:outputText value="TFA Reviewer"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:inputField value="{!drObject.TFA_Review_User__c}"/>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem> 
                
                <apex:pageBlockSectionItem rendered="{!IF(drObject.Target_Environment_txt__c == 'Production', false, true)}">
                    <apex:outputText value="Is TA/Code Review Completed"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:selectList value="{!drObject.Is_TA_Review_Completed_txt__c}" multiselect="false" size="1">
                        <apex:selectOptions value="{!taReviewCompleted}"/>
                    </apex:selectList>   
                    </apex:outputPanel>             
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem rendered="{!IF(drObject.Target_Environment_txt__c == 'Production', false, true)}">
                    <apex:outputText value="TA/Code Reviewer"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:inputField value="{!drObject.TA_Review_User__c}"/>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem rendered="{!IF(drObject.Target_Environment_txt__c == 'Production', false, true)}">
                    <apex:outputText value="Is Code Review Completed"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:selectList value="{!drObject.Is_Code_Review_Completed_txt__c}" multiselect="false" size="1">
                        <apex:selectOptions value="{!codeReviewCompleted}"/>
                    </apex:selectList>   
                    </apex:outputPanel>             
                </apex:pageBlockSectionItem>                
                <apex:inputField value="{!drObject.Code_Review_User__c}" rendered="{!IF(drObject.Target_Environment_txt__c == 'Production', false, true)}"/> 
                
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Support KT Status"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:selectList value="{!drObject.Support_KT_Status_txt__c}" multiselect="false" size="1">
                        <apex:selectOptions value="{!supportKTStatus}"/>
                    </apex:selectList>  
                    </apex:outputPanel>              
                </apex:pageBlockSectionItem>  
                
                            
                <apex:inputField value="{!drObject.Support_KT_Date__c}"/>
                <apex:pageBlockSectionItem rendered="{!IF(drObject.Target_Environment_txt__c == 'Production', true, false)}">
                    <apex:outputText value="Test Approver"></apex:outputText>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                    <apex:outputPanel layout="block" styleClass="requiredBlock"/>
                    <apex:inputField value="{!drObject.UAT_Test_Approver__c}"/>
                    </apex:outputPanel>                
                </apex:pageBlockSectionItem>   
                             
           </apex:pageBlockSection> 
            <!--
            <apex:pageBlockSection title="Release Management/SDM">
                <apex:inputField value="{!drObject.RM_Approval_Date__c}"/>
            </apex:pageBlockSection>-->
            <!--
            <apex:pageBlockSection title="Deployment Status">
                <apex:inputField value="{!drObject.Administrator_to_Deploy__c}"/>
                <apex:inputField value="{!drObject.Deployment_End_Date_Time__c}"/>
                <apex:inputField value="{!drObject.Deployment_Start_Date_Time__c}"/>
                <apex:inputField value="{!drObject.Submitted_Date__c}"/>
                <apex:inputField value="{!drObject.Approval_Date__c}"/>
            </apex:pageBlockSection>   -->
            <!--                   
            <apex:pageBlockSection title="Deployment Comments">
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Additional Notes"></apex:outputText>
                    <apex:selectList value="{!drObject.Additional_Comments_txt__c}" multiselect="false" size="1">
                        <apex:selectOptions value="{!additionalNotes}"/>
                    </apex:selectList>                
                </apex:pageBlockSectionItem>                
                <apex:inputField value="{!drObject.Administrator_Comment__c}" style="width:200px;"/>
            </apex:pageBlockSection>  -->     
            
            <apex:pageBlockSection title="Additional Notification" id="AdditionalNot"> 
            <apex:inputField value="{!drObject.User_1__c}" rendered="{!drObject.User_1__c ==null}"/>
            <apex:outputField value="{!drObject.User_1__c}" rendered="{!drObject.User_1__c !=null}"/>
            
            <apex:inputField value="{!drObject.User_2__c}" rendered="{!drObject.User_2__c ==null}" />
            <apex:outputField value="{!drObject.User_2__c}" rendered="{!drObject.User_2__c !=null}"/>
            
            <apex:inputField value="{!drObject.User_3__c}" rendered="{!drObject.User_3__c ==null}"/>
            <apex:outputField value="{!drObject.User_3__c}" rendered="{!drObject.User_3__c !=null}"/>
            
            <apex:inputField value="{!drObject.User_4__c}" rendered="{!drObject.User_4__c ==null}"/>
            <apex:outputField value="{!drObject.User_4__c}" rendered="{!drObject.User_4__c !=null}"/>
            
            </apex:pageBlockSection>
                                   
            </apex:pageBlock>
    </apex:form>
</apex:page>