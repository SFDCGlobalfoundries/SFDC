<!--
 *      Page:          CPQAdvancedPackagingOptions
 *-----------------------------------------------------------------------------------------------------------------------------
 *      Author:        Shivam Sharma
 *  Created Date:      11/25/2015
 *      Reason:        Captures all the Advanced Packaging Options for Configurator plus
 *-----------------------------------------------------------------------------------------------------------------------------
 -->
<apex:page title="Advanced Packaging Options" standardController="Apttus_Proposal__Proposal__c" extensions="CPQ_AdvancedPackagingOptions_Controller">
<apex:sectionHeader title="Select Advanced Packaging Options" 
                    subtitle="Configurator Plus Advanced Packaging Options"/> 
  
  <apex:form id="theForm">
      <apex:pageBlock >
          <apex:pageMessages id="theMessages"></apex:pageMessages>
          <apex:pageblockButtons >
              <apex:commandButton value="Save" action="{!saveAction}"  status="status" rendered="{!!readOnlyModeEnabled}"/>
              <apex:commandButton value="Cancel" action="{!Cancel}" status="status" rendered="{!!readOnlyModeEnabled}"/>
              <apex:commandButton value="Go Back to Configurator Plus" action="{!Cancel}" rendered="{!readOnlyModeEnabled}"/>
          </apex:pageblockButtons>
          <apex:pageBlock >
          <apex:pageblockSection title="Packaging Options">
              <apex:outputField value="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c}"/>
              <apex:outputField value="{!Apttus_Proposal__Proposal__c.APTPS_Metal_Options__c}"/>
              
              <!-- Flip Chip Specific fields -->
                  <apex:outputField value="{!Apttus_Proposal__Proposal__c.Die_Thickness_in_package__c}" rendered="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c == 'Flip Chip'}"/>
                  <apex:outputField value="{!Apttus_Proposal__Proposal__c.Bumping_for_FC__c}" rendered="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c == 'Flip Chip'}"/>
                  <apex:outputField value="{!Apttus_Proposal__Proposal__c.Bump_for_FC__c}" rendered="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c == 'Flip Chip'}"/>
                  <apex:outputField value="{!Apttus_Proposal__Proposal__c.Minimum_Bump_In_Line_pad_pitch__c}" rendered="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c == 'Flip Chip'}"/>
                  <apex:outputField value="{!Apttus_Proposal__Proposal__c.Package_Substrate_Type_for_FC__c}" rendered="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c == 'Flip Chip'}"/>
                  
              <!-- Wirebond Specific Fields -->
                  <apex:outputField value="{!Apttus_Proposal__Proposal__c.Circuit_Under_Bond_Pad_for_WB_picklist__c}" rendered="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c == 'Wirebond'}"/>
                  <apex:outputField value="{!Apttus_Proposal__Proposal__c.Wire_Diameter_for_WB__c}" rendered="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c == 'Wirebond'}"/>
                  <apex:outputField value="{!Apttus_Proposal__Proposal__c.Pad_Opening_for_WB__c}" rendered="{!Apttus_Proposal__Proposal__c.APTPS_Packaging_Option__c == 'Wirebond'}"/>
          </apex:pageblockSection>
      </apex:pageBlock>
      <apex:pageBlock >
          <apex:outputPanel id="theOuterOutputPanel">
             <br/><br/> 
              <apex:pageblockSection id="theSection" title="Advanced Packaging Options" columns="4">
                  <apex:repeat value="{!questionsByLevel}" var="level">
                  <apex:repeat value="{!questionsByLevel[level]}" var="questionId">
                      
                      <apex:outputText value="{!mapOfQuestions[questionId].queName}"></apex:outputText>
                      
                      <apex:outputPanel id="theInnerOutputpanel1" rendered="{!mapOfQuestions[questionId].dataType=='Picklist' && !readOnlyModeEnabled}">
                          <apex:selectList size="1" value="{!mapOfQuestions[questionId].answer}" disabled="{!!mapOfQuestions[questionId].isEnabled}">
                              <apex:selectOptions value="{!mapOfQuestions[questionId].picklistValues}"></apex:selectOptions>
                              <apex:actionSupport event="onchange"   action="{!getreEvaluatePicklistValuesOfChildQuestions}" reRender="theOuterOutputPanel, theMessages" status="status"/>
                          </apex:selectList>
                          <apex:outputText value="{!mapOfQuestions[questionId].errorMessage}" style="color:red;"></apex:outputText>
                      </apex:outputPanel>
                      
                      <apex:outputPanel id="theInnerOutputpanel2" rendered="{!mapOfQuestions[questionId].dataType=='Text' && !readOnlyModeEnabled}">
                          <apex:inputText value="{!mapOfQuestions[questionId].answer}" disabled="{!!mapOfQuestions[questionId].isEnabled}" />
                          <apex:outputText value="{!mapOfQuestions[questionId].errorMessage}" style="color:red;"></apex:outputText>
                      </apex:outputPanel>
                      
                      <apex:outputPanel id="theInnerOutputPanelReadOnly" rendered="{!readOnlyModeEnabled}">
                          <apex:outputText value="{!mapOfQuestions[questionId].answer}"></apex:outputText>
                      </apex:outputPanel>
                  </apex:repeat>
                  </apex:repeat>
              </apex:pageblockSection>
                <apex:actionStatus id="status">
                    <apex:facet name="start">
                    <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.25; z-index: 1000; background-color: black;">
                        &nbsp;
                    </div>
                    <div style="position: fixed; left: 0; top: 0; bottom: 0; right: 0; z-index: 1001; margin: 15% 50%">
                        <div style="display: inline-block; padding: 2px; background-color: #fff; width: 125px;">
                            <img src="/img/loading.gif" style="float: left; margin: 8px;" />
                            <span style="display: inline-block; padding: 10px 0px;">Please Wait...</span>
                        </div>
                    </div>
                    </apex:facet>
                </apex:actionStatus>
                  <apex:pageblockSection title="Stack Options Available" rendered="{!!hasMetalOptions}">
                  No Metal Options Selected
                  </apex:pageBlockSection>
                  <apex:pageblockSection id="theSection2" title="Stack Options Available" columns="4" rendered="{!hasMetalOptions}">
                  <apex:repeat value="{!questionsForMetalStack}" var="level">
                  <apex:repeat value="{!questionsForMetalStack[level]}" var="questionId">
                      
                      <apex:outputText value="{!mapOfQuestions[questionId].queName}"></apex:outputText>
                      
                      <apex:outputPanel id="theInnerOutputpanel21" rendered="{!mapOfQuestions[questionId].dataType=='Picklist' && !readOnlyModeEnabled}">
                          <apex:selectList size="1" value="{!mapOfQuestions[questionId].answer}" disabled="{!!mapOfQuestions[questionId].isEnabled}">
                              <apex:selectOptions value="{!mapOfQuestions[questionId].picklistValues}"></apex:selectOptions>
                              <apex:actionSupport event="onchange"   action="{!getreEvaluatePicklistValuesOfChildQuestions}" reRender="theOuterOutputPanel, theMessages"/>
                          </apex:selectList>
                          <apex:outputText value="{!mapOfQuestions[questionId].errorMessage}" style="color:red;"></apex:outputText>
                      </apex:outputPanel>
                      
                      <apex:outputPanel id="theInnerOutputpanel22" rendered="{!mapOfQuestions[questionId].dataType=='Text' && !readOnlyModeEnabled}">
                          <apex:inputText value="{!mapOfQuestions[questionId].answer}" disabled="{!!mapOfQuestions[questionId].isEnabled}" />
                          <apex:outputText value="{!mapOfQuestions[questionId].errorMessage}" style="color:red;"></apex:outputText>
                      </apex:outputPanel>
                      <apex:outputPanel id="theInnerOutputPanel22ReadOnly" rendered="{!readOnlyModeEnabled}">
                          <apex:outputText value="{!mapOfQuestions[questionId].answer}"></apex:outputText>
                      </apex:outputPanel>
                  </apex:repeat>
                  </apex:repeat>
              </apex:pageblockSection>
             
          </apex:outputPanel>
      </apex:pageBlock>        
      </apex:pageBlock>
  </apex:form>
</apex:page>