<!-- 
Type Name: DocumentUploadPage.page
Author: Global Foundries (Dinesh Suggala) 
Created Date: 13-06-2017
Reason: This Page is used to Upload a document into the Folder
Change History:
Author: Dinesh Suggala    
Modified Date: 26/10/2017
Reason:Added Custom Button(+) Symbol for multiple uploads in same page.
 -->

<apex:page standardController="Folder__c" extensions="DocumentUploadPageController" showheader="false" id="pg">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script>

<apex:outputPanel id="panel">
<script>
        $(document).ready(function(){          
        setUpload();
        });
        
        function setUpload(){
        
        $('#publisherAttachContentPost').trigger('click');
        $('#chatterUploadFileAction').trigger('click');
        $('.uploadFileSizeLimit').hide();           
        $('.contentPublisherSlideDown.customPanel.alignTop').css('border', '2');
        $('.clearContentPanelButtonContainer').hide();
        $('.publisherFeedItemTypeChoices').hide();      
        $('.cxfeedinnerwrapper').hide();  
        $('.publisherBottomBarPlaceholder').hide();
        $('.publisherTextAreaPlaceholder.alignCenter').remove();
        $('.publisherTextAreaPlaceholder.alignTop').remove();
        }
     
   function uploadFile(){
             if($('.file')[1].files.length > 0){
                   $('#publishersharebutton').trigger('click');
                   
             }
             else{
                   alert('Please select a file');
             }            
           }
           
   function success(){
            
             window.top.close();
             window.opener.location = window.opener.window.location;            
            
        }     
</script>
</apex:outputPanel>
 <apex:pageBlock title="Upload Documents" id="pgblock">
   <apex:pagemessages id="msg"/>
    <chatter:feed entityId="{!Folder__c.Id}" id="chatter"/>
    <apex:form >
      <apex:commandButton value="Upload" onclick="uploadFile();" action="{!UploadedTrue}" reRender="msg" />      
      <apex:commandButton value="Close&Refresh" onclick="success();"  />
      <apex:commandButton value="+" reRender="pgblock" action="{!dummy}" oncomplete="setUpload();"    /> 
    </apex:form>
 </apex:pageBlock> 
</apex:page>