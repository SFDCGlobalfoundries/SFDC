/**
 * 22-Sep-2015: Swift Team created
 * 
 */
@isTest
private class PTRF_FrameGen_DRW_StatusUpdateTest {

    @testSetup
    static void setupTestData() {
        SwiftDataUtilityTest.customSystemData();
        initialData();
    }

    static testMethod void FrameGen_DRWNoOrderStatus_test() {
        PTRF__c ptrf1 = [select id,name from ptrf__c limit 1];
        PTRF_FrameGen_DRW_StatusUpdate.FrameGen_DRWNoOrderStatus(new set<id>{ptrf1.id}, new set<string>{ptrf1.name});
    }
    
    static testMethod void FrameGen_DRWStartStatus_test() {
        PTRF__c ptrf1 = [select id,name from ptrf__c limit 1];
        PTRF_FrameGen_DRW_StatusUpdate.FrameGen_DRWStartStatus(new set<id>{ptrf1.id}, new set<string>{ptrf1.name});
    }
    
    static testMethod void FrameGen_DRWCompletedStatus_test() {
        list<MRS_Layer_Chip_Association__c> layerChips = [select id from MRS_Layer_Chip_Association__c];
        for(MRS_Layer_Chip_Association__c m: layerChips) {
            m.drw__c = 'In Progress';
        }
        update layerChips;
        
        PTRF__c ptrf1 = [select id,name from ptrf__c limit 1];
        PTRF_FrameGen_DRW_StatusUpdate.FrameGen_DRWCompletedStatus(new set<id>{ptrf1.id}, new set<string>{ptrf1.name});
    }
    
    static testMethod void FrameGen_FGStatus_test() {
        PTRF__c ptrf1 = [select id,name from ptrf__c limit 1];
        PTRF_FrameGen_DRW_StatusUpdate.FrameGen_FGStatus(new set<id>{ptrf1.id}, new set<string>{ptrf1.name});
    }
    
    static testMethod void FrameGen_FGRerunStatus_test() {
        list<MRS_Layer_Chip_Association__c> layerChips = [select id from MRS_Layer_Chip_Association__c];
        for(MRS_Layer_Chip_Association__c m: layerChips) {
            m.Customer_Frame_Mockup__c = 'Ready';
            m.Foundry_Frame_Mockup__c = 'Ready';
        }
        update layerChips;
        
        PTRF__c ptrf1 = [select id,name from ptrf__c limit 1];
        PTRF_FrameGen_DRW_StatusUpdate.FrameGen_FGRerunStatus(new set<id>{ptrf1.id}, new set<string>{ptrf1.name});
    }
    
    static testMethod void sendEmail_test() {
        PTRF_FrameGen_DRW_StatusUpdate.sendMail('e', 'ptrfnumber',  'operation');
    }
    
    public static void initialData() {
        
        Mask_Set_Title__c mst = SwiftDataUtilityTest.createMST( 'MPW789');
        insert mst;
        
        DRT__c drt1 = new DRT__c( Name='testFrame', Synced_with_Oracle_DB__c=false, DRT_Package_Sync__c=false, Status__c='Active', Mask_Set_Title__c = mst.Id );          
        insert drt1;
        
        PTRF__c ptrf1 = new PTRF__c( Name='PTRF-20189-522', Order_Type__c = 'testOrder1', Recticle_Type__c='Multi Layer Reticle (MLR)', 
            Customer_jobview__c='Gating Mask Release', MaskSetTitle__c = mst.id, Status__c = 'Perform Tapeout Options',Tech_Geo_Value__c = '0.018'
        );
        insert ptrf1;
        
        DRT_PTRF_Association__c drtPtrfIns = new DRT_PTRF_Association__c( DRT__c = drt1.id, PTRF__c = ptrf1.id);
        //insert drtPtrfIns ;
        
        MRS__c mrs1 = new MRS__c( Full_Sync__c =true, Synced_with_Oracle_DB__c=false, MRS_Package_Sync__c=false, Mask_Set_Title__c=mst.Id);
        insert mrs1;
        
        MRS_Layer_Association__c mrsLayer1 = new MRS_Layer_Association__c( Name ='BV', Synced_with_Oracle_DB__c=false, Mask_Layer_Rev__c = 'AZ',
            Layer_Name__c = 'AZ', Layer_Status__c = 'Not Ready', mrs__c = mrs1.id
        );
        insert mrslayer1;
        
        MRS_Layer_Association__c mrsLayer2 = new MRS_Layer_Association__c( Name ='C7', Synced_with_Oracle_DB__c=false, Mask_Layer_Rev__c = 'AZ',
            Layer_Name__c = 'C7', Layer_Status__c = 'Not Ready', mrs__c = mrs1.id
        );
        insert mrslayer2;   
        
        MRS_Chip_Details__c mrsChip1 = new MRS_Chip_Details__c( Name='PD123', Synced_with_Oracle_DB__c=false, mrs__c = mrs1.id);        
        insert mrsChip1; 
        
        MRS_Chip_Details__c mrsChip2 = new MRS_Chip_Details__c( Name='Frame', Synced_with_Oracle_DB__c=false, mrs__c = mrs1.id);        
        insert mrsChip2; 
        
        
        MRS_Layer_Chip_Association__c layerChipFrame = new MRS_Layer_Chip_Association__c(
            Synced_with_Oracle_DB__c=false, Send_Frame_Data__c = 'Not Done', Send_Prime_Data__c = 'Not Done', /*DRT__c=drt1.id,*/
            Layer__c=mrsLayer1.Id, Foundry_GDSOUT_Review__c = 'Not Ready', Chip__c=mrsChip2.Id, PTRF__c=ptrf1.Id, GlobalShuttle_MEBES_Jobview__c= 'Not Ready',
            TDTI_MPW_MEBES_Jobview__c = 'Not Ready', MDP_MEBES_Jobview__c = 'Not Ready', Tapeout_Centre_MEBES_Jobview__c = 'Not Ready',         
            Tapeout_Applications_MEBES_Jobview__c = 'Not Ready', Foundry_MEBES_Jobview__c = 'Not Ready', Customer_MEBES_Jobview__c = 'Not Ready',
            Frame_MEBES_Received__c = 'Not Done', Prime_MEBES_Received__c = 'Not Done', Mask_Set_Title_Id__c = mst.id, PTRF_Or_DRT__c = 'PTRF',
            Customer_Frame_Mockup__c = 'Not Ready',Foundry_Frame_Mockup__c = 'Not Ready'
            
        );
        insert layerChipFrame;
        
        MRS_Layer_Chip_Association__c layerChip1 = new MRS_Layer_Chip_Association__c(
            Synced_with_Oracle_DB__c=false, Send_Frame_Data__c = 'Not Done', Send_Prime_Data__c = 'Not Done', /*DRT__c=drt1.id,*/
            Layer__c=mrsLayer1.Id, Foundry_GDSOUT_Review__c = 'Not Ready', Chip__c=mrsChip1.Id, PTRF__c=ptrf1.Id, GlobalShuttle_MEBES_Jobview__c= 'Not Ready',
            TDTI_MPW_MEBES_Jobview__c = 'Not Ready', MDP_MEBES_Jobview__c = 'Not Ready', Tapeout_Centre_MEBES_Jobview__c = 'Not Ready',         
            Tapeout_Applications_MEBES_Jobview__c = 'Not Ready', Foundry_MEBES_Jobview__c = 'Not Ready', Customer_MEBES_Jobview__c = 'Not Ready',
            Frame_MEBES_Received__c = 'Not Done', Prime_MEBES_Received__c = 'Not Done', Mask_Set_Title_Id__c = mst.id, PTRF_Or_DRT__c = 'PTRF',
            drw__c = 'Not Ready'
        );
        insert layerChip1;
        
        MRS_Layer_Chip_Association__c layerChip2 = new MRS_Layer_Chip_Association__c(
            Synced_with_Oracle_DB__c=false, Send_Frame_Data__c = 'Not Done', Send_Prime_Data__c = 'Not Done',  /*DRT__c=drt1.id,*/
            Layer__c=mrsLayer2.Id, Foundry_GDSOUT_Review__c = 'Not Ready', Chip__c=mrsChip1.Id, PTRF__c=ptrf1.Id, GlobalShuttle_MEBES_Jobview__c= 'Not Ready',
            TDTI_MPW_MEBES_Jobview__c = 'Not Ready', MDP_MEBES_Jobview__c = 'Not Ready', Tapeout_Centre_MEBES_Jobview__c = 'Not Ready',
            Tapeout_Applications_MEBES_Jobview__c = 'Not Ready', Foundry_MEBES_Jobview__c = 'Not Ready', Customer_MEBES_Jobview__c = 'Not Ready',
            Frame_MEBES_Received__c = 'Not Done', Prime_MEBES_Received__c = 'Not Done', Mask_Set_Title_Id__c = mst.id, PTRF_Or_DRT__c = 'DRT',
            drw__c = 'Not Ready'
        );
        insert layerChip2;
    }
}